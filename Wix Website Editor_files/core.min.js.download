define("core/utils/addComponentPlugins/plugins/page",["lodash","constants","util"],function(t,e,n){"use strict";function i(e,n,i){t.forEach(i,function(i){var o=function(e,n,i){var o=n;return t.forEach(i,function(t){var n=e.components.getChildren(o);o=n[t]}),o}(e,n,i.pathToParent),r=e.theme.styles.createItem(i.style),s=e.documentServices.tpa.widget.add(i.appDefinitionId,{widgetId:i.widgetId,pageId:n.id,parentContainerRef:o,layout:i.layout,styleId:r});t.forOwn(i.data,function(t,n){e.documentServices.tpa.data.set(s,n,t)})})}function o(t,n,i,o){t.history.add("adding new popup",{actionType:e.DS_ACTIONS.ADD_PAGE,nextPage:n.id,currentPage:i}),t.documentServices.waitForChangesApplied(function(){var e=t.pages.popupPages.getPopupContainer(n.id);t.selection.selectComponentByCompRef(e),o(e)})}return function(e,r,s,a,u,c){if(a.data.isPopup){a.layout.x=0,a.layout.y=0,a.data.pageUriSEO=null;var l=t.omit(a,"tpaComps"),p=e.pages.popupPages.add(n.translate(l.data.title),l),d=e.documentServices.pages.getFocusedPageId();return e.pages.navigateTo(p.id),a.tpaComps?e.documentServices.waitForChangesApplied(function(){i(e,p,a.tpaComps),o(e,p,d,c)}):o(e,p,d,c),p}return null}}),define("core/utils/addComponentPlugins/plugins/anchor",["lodash","util"],function(t,e){"use strict";function n(e,n,i){var o,r=function(e,n,i){var o=new RegExp(i+"\\s(\\d+)"),r=[];return t.forEach(n,function(t){var n=e.components.data.get(t).name.match(o);n&&r.push(parseInt(n[1],10))}),r}(e,n,i);for(r.sort(function(t,e){return t-e}),o=0;o<r.length;++o)if(!t.includes(r,o+1))return o+1;return o+1}return function(t,i,o,r,s,a){var u=e.translate("component_label_anchor"),c=t.documentServices.pages.getReference(t.documentServices.pages.getPrimaryPageId()),l=n(t,t.components.get.byType("wysiwyg.common.components.anchor.viewer.Anchor",c),u);r.data.name=u+" "+l;var p=i(o,r);return a&&t.documentServices.waitForChangesApplied(function(){a(p)}),p}}),define("core/utils/updateDataPlugins/plugins/imageData",["util"],function(t){"use strict";return function(e){return e.title&&(e.title=t.media.fixMediaTitleLength(e.title,100)),e.description&&(e.description=t.media.fixMediaTitleLength(e.description,1200)),e}}),define("core/utils/updateDataPlugins/plugins/vectorImageData",["util"],function(t){"use strict";return function(e){return e.title&&(e.title=t.media.fixMediaTitleLength(e.title,100)),e}}),define("core/utils/updateDataPlugins/plugins/wixVideoData",["util"],function(t){"use strict";return function(e){return e.title&&(e.title=t.media.fixMediaTitleLength(e.title,100)),e}}),define("core/utils/updateDataPlugins/updateDataPlugins",["core/utils/updateDataPlugins/plugins/imageData","core/utils/updateDataPlugins/plugins/vectorImageData","core/utils/updateDataPlugins/plugins/wixVideoData"],function(t,e,n){"use strict";return{Image:t,VectorImage:e,WixVideo:n}}),define("core/utils/addComponentPlugins/plugins/commonUtils/addMultiple",["lodash","core/utils/updateDataPlugins/updateDataPlugins"],function(t,e){"use strict";return function(n,i,o,r,s,a,u,c){t.forEach(c,function(s,c){var l,p,d;c>0?(d=n.documentServices.pages.getFocusedPageId(),p=n.pasteLogic.addContext.getPastePosition(n,r.layout,d),l=c>0?t.merge({},r,{layout:p}):r):l=r;var g=u(l,s),m=g.data&&g.data.type;e[m]&&(g.data=e[m](g.data));var h=i(o,g);a&&n.documentServices.waitForChangesApplied(function(){a(h)})})}}),define("core/utils/addComponentPlugins/plugins/documentMedia",["lodash","core/utils/addComponentPlugins/plugins/commonUtils/addMultiple","util"],function(t,e,n){"use strict";function i(e,n){return t.merge({},e,{data:{title:n.title,link:{docId:t.last(n.fileUrl.split("/")),name:n.title,type:"DocumentLink"}}})}return function(t,o,r,s,a,u){if(s.data.link&&s.data.link.docId)return!1;var c=t.mediaServices;return c.mediaManager.open(c.mediaManager.categories.DOCUMENT,{callback:function(n){e(t,o,r,s,a,u,i,n)},translation:{submitButton:n.translate("MMGR_submitbutton_addpanel_mydocs_add")}}),!0}}),define("core/utils/addComponentPlugins/plugins/commonUtils/addAudioPluginUtil",["lodash","core/utils/addComponentPlugins/plugins/commonUtils/addMultiple","util"],function(t,e,n){"use strict";return{handleAudioAdd:function(t,i,o,r,s,a,u){if(r.data.uri)return!1;var c=t.mediaServices;return c.mediaManager.open(c.mediaManager.categories.MUSIC,{callback:function(n){e(t,i,o,r,s,a,u,n)},translation:{submitButton:n.translate("MMGR_submitbutton_addpanel_mytracks_add")}}),!0}}}),define("core/utils/addComponentPlugins/plugins/audioPlayer",["lodash","core/utils/addComponentPlugins/plugins/commonUtils/addAudioPluginUtil"],function(t,e){"use strict";function n(e,n){return t.merge({},e,{data:{uri:n.fileName,originalFileName:n.title}})}return function(t,i,o,r,s,a){return e.handleAudioAdd(t,i,o,r,s,a,n)}}),define("core/utils/addComponentPlugins/plugins/singleAudioPlayer",["lodash","core/utils/addComponentPlugins/plugins/commonUtils/addAudioPluginUtil"],function(t,e){"use strict";function n(e,n){return t.merge({},e,{data:{uri:n.fileName,originalFileName:n.title,artist:"Unknown Artist",track:"Unknown Track"}})}return function(t,i,o,r,s,a){return e.handleAudioAdd(t,i,o,r,s,a,n)}}),define("core/utils/componentPreviewReadyPlugins/formPlugin",["lodash"],function(t){"use strict";function e(e,n){var i=e.toEmailAddress,o=n.documentServices.generalInfo.getUserInfo().email;i||function(e){return t.endsWith(e,"@wix.com")}(o)||(e.toEmailAddress=o)}return{updateDataWithDefaults:e}}),define("core/utils/addComponentPlugins/plugins/contactForm",["lodash","util","core/utils/componentPreviewReadyPlugins/formPlugin"],function(t,e,n){"use strict";var i={successMessage:"Contact_Form_Settings_Messages_Success_message_default",validationErrorMessage:"Contact_Form_Settings_Messages_Error_message_mandatory_fields_default",errorMessage:"Contact_Form_Settings_Messages_Error_message_for_email_fields_default"};return function(o,r,s,a,u,c){!function(n){t.forOwn(i,function(t,i){n[i]=e.translate(t)})}(a.data),n.updateDataWithDefaults(a.data,o);var l=r(s,a);return c&&o.documentServices.waitForChangesApplied(function(){c(l)}),l}}),define("core/utils/addComponentPlugins/plugins/clipArt",["lodash","experiment"],function(t,e){"use strict";var n="full",i="fit";return function(o,r,s,a,u,c){a.props||(a=function(o){return t.merge(o,{data:{title:""},layout:{rotationInDegrees:0,scale:1,fixedPosition:!1,anchors:[]},props:{displayMode:e.isOpen("se_addPanelClipArtToIllustration")?i:n,type:"WPhotoProperties"},style:o.style||"ca1"})}(a));var l=r(s,a);return c&&o.documentServices.waitForChangesApplied(function(){c(l)}),l}}),define("core/utils/addComponentPlugins/plugins/svgShape",["lodash"],function(t){"use strict";return function(e,n,i,o,r,s){var a=n(i,function(e){return t.defaults(e,{data:{link:null,type:"SvgShape"}})}(o));return s&&e.documentServices.waitForChangesApplied(function(){s(a)}),a}}),define("core/utils/addComponentPlugins/plugins/wPhoto",["lodash"],function(t){"use strict";return function(e,n,i,o,r,s){o.props||(o=function(e){return t.merge(e,{layout:{rotationInDegrees:0,scale:1,fixedPosition:!1,anchors:[]},props:{type:"WPhotoProperties"},style:e.style||"wp2"})}(o));var a=n(i,o);return s&&e.documentServices.waitForChangesApplied(function(){s(a)}),a}}),define("core/app/constants",["constants"],function(t){"use strict";return t}),define("core/utils/addComponentPlugins/plugins/verticalAnchorsMenu",["lodash","core/app/constants"],function(t,e){"use strict";return function(t,n,i,o,r,s){var a=o.layout;a.fixedPosition&&(a.docked.right.px+=e.SECTIONS_REORGANIZE.STRIP_WIDTH,a.docked.right.px+=t.isVerticalScrollbarHidden()?.01*window.innerWidth:e.SECTIONS_REORGANIZE.STRIP_WIDTH,delete a.x,delete a.y);var u=n(i,o);return s&&t.documentServices.waitForChangesApplied(function(){s(u)}),u}}),define("core/utils/addComponentPlugins/plugins/stripContainer",[],function(){"use strict";return function(t,e,n,i){i.layout.x=0}}),define("core/utils/addComponentPlugins/plugins/appControllerAddPlugin",["lodash"],function(t){"use strict";return function(e,n,i){var o=e.components.data.get(n),r=e.documentServices.platform.getAppDataByAppDefId(o.applicationId);if(r){var s={eventType:"controllerAdded",eventPayload:{controllerRef:n}};i&&t.assign(s,{origin:i}),e.documentServices.platform.notifyApplication(r.applicationId,s)}}}),define("core/utils/addComponentPlugins/plugins/vectorImageBefore",["lodash"],function(t){"use strict";return function(e,n,i,o){var r=o.data.svgId;e.media.vectorImage.fetchSvg(r,t.noop)}}),define("core/utils/layoutConstraintsUtil/boundariesConstraintsUtil",["lodash"],function(t){"use strict";function e(e,n,i){!function(e,n,i){var o=n.x,r=n.x+n.width,s=e.left;s&&(t.isNumber(s.compLeftX)&&(i.x&&o<s.compLeftX&&(n.x+=s.compLeftX-o),i.width&&o<s.compLeftX&&(n.width-=s.compLeftX-o)),t.isNumber(s.compRightX)&&(i.x&&r<s.compRightX&&(n.x+=s.compRightX-r),i.width&&r<s.compRightX&&(n.width+=s.compRightX-r)))}(e,n,i),function(e,n,i){var o=n.x,r=n.x+n.width,s=e.right;s&&(t.isNumber(s.compRightX)&&(i.x&&r>s.compRightX&&(n.x+=s.compRightX-r),i.width&&r>s.compRightX&&(n.width+=s.compRightX-r)),t.isNumber(s.compLeftX)&&(i.x&&o>s.compLeftX&&(n.x+=s.compLeftX-o),i.width&&o>s.compLeftX&&(n.width-=s.compLeftX-o)))}(e,n,i)}function n(e,n,i){!function(e,n,i){var o=n.y,r=n.y+n.height,s=e.top;s&&(t.isNumber(s.compTopY)&&(i.y&&o<s.compTopY&&(n.y+=s.compTopY-o),i.height&&o<s.compTopY&&(n.height-=s.compTopY-o)),t.isNumber(s.compBottomY)&&(i.y&&r<s.compBottomY&&(n.y+=s.compBottomY-r),i.height&&r<s.compBottomY&&(n.height+=s.compBottomY-r)))}(e,n,i),function(e,n,i){var o=n.y,r=n.y+n.height,s=e.bottom;s&&(t.isNumber(s.compBottomY)&&(i.y&&r>s.compBottomY&&(n.y+=s.compBottomY-r),i.height&&r>s.compBottomY&&(n.height+=s.compBottomY-r)),t.isNumber(s.compTopY)&&(i.y&&o>s.compTopY&&(n.y+=s.compTopY-o),i.height&&o>s.compTopY&&(n.height-=s.compTopY-o)))}(e,n,i)}function i(i,o,r,s,a){var u=function(e,n){return t(e).pick(["x","y","width","height"]).pickBy(function(e,i){return!t.isEqual(e,n[i])}).mapValues(function(t,e){return e}).value()}(s,a);(i.left||i.right)&&e(i,s,u),(i.top||i.bottom)&&n(i,s,u)}return{applyBoundariesConstraintOnLayout:i}}),define("core/utils/layoutConstraintsUtil/LayoutConstraintsUtil",["lodash","core/utils/layoutConstraintsUtil/boundariesConstraintsUtil"],function(t,e){"use strict";function n(n,i,o){return t(o).filter(function(e){return function(e){return t.isFunction(e.applyConstraint)||t.isFunction(e.getBoundaries)}(e)&&(!t.isFunction(e.shouldConstrain)||e.shouldConstrain(n,i))}).map(function(o){var r=t.clone(o);return r.applyConstraint||(r.applyConstraint=e.applyBoundariesConstraintOnLayout.bind(null,r.getBoundaries(n,i))),r}).value()}function i(t,e,i){this.constraintsToApply=n(t,e,i)}return i.prototype.applyConstraints=function(e,n,i,o){var r=t.assign({},o,i);t.forEach(this.constraintsToApply,function(t){t.applyConstraint(e,n,r,o)}),t.assign(i,t.pick(r,t.keys(i)))},i.prototype.getConstraintArea=function(e,n){var i=t(this.constraintsToApply).filter(function(e){return t.isFunction(e.getConstraintArea)}).invokeMap("getConstraintArea",e,n).compact().flatten().value();return t.isEmpty(i)?null:i},i.prototype.hasConstraints=function(){return!t.isEmpty(this.constraintsToApply)},i}),define("core/utils/layoutConstraintsUtil/layoutConstraints/stretchToScreenConstraints",["lodash"],function(t){"use strict";function e(e,i,o,r){var s,a=e.getPreviewPosition().width,u=function(e,n){return t(e).pick(["x","y","width","height"]).pickBy(function(e,i){return!t.isEqual(e,n[i])}).mapValues(function(t,e){return e}).value()}(o,r);if(u.x){var c=o.x,l=n;(s=t.min([l-c,0]))&&(o.x+=s)}if(u.width){var p=o.x+o.width,d=a-n;(s=t.max([d-p,0]))&&(o.width+=s)}}var n=80;return{shouldConstrain:function(t,e){return t.components.layout.isHorizontallyStretchedToScreen(e)},applyConstraint:e}}),define("core/utils/layoutConstraintsUtil/layoutConstraints/constraintsUtil",["lodash"],function(t){"use strict";return{isShownOnAllPagesComponent:function(e,n){var i=t.isArray(n)?n:[n];return t.some(i,function(t){return e.components.isShowOnAllPages(t)&&!e.utils.isSameRef(t,e.documentServices.siteSegments.getFooter())})}}}),define("core/utils/layoutConstraintsUtil/layoutConstraints/mobileBoundariesConstraints",["lodash","core/utils/layoutConstraintsUtil/layoutConstraints/constraintsUtil","stateManagement","core/app/constants"],function(t,e,n,i){"use strict";function o(t,e){var n=t.siteSegments[e].call(t.siteSegment);return t.components.layout.getRelativeToScreen(n)}function r(t,e){return{left:t.x,width:t.width,height:t.height-e.height}}function s(e,n){var i=o(e,d.HEADER);return t.assign(r(n,i),{top:n.y+i.height})}function a(t,e){return t.utils.isSameRef(e,t.documentServices.siteSegments.getHeader())}function u(t,e){return t.utils.isSameRef(e,t.documentServices.siteSegments.getFooter())}function c(t,e){return"SiteRegionContainer"===g.getCompTypeSuffix(e,t.documentServices)}function l(t){var e=o(t,d.SITE_STRUCTURE);return{top:{compBottomY:i.SIZE_LIMITS.MOBILE_DRAG_CONSTRAINT_MARGINS},bottom:{},left:{compRightX:e.x+i.SIZE_LIMITS.MOBILE_DRAG_CONSTRAINT_MARGINS},right:{compLeftX:e.x+e.width-i.SIZE_LIMITS.MOBILE_DRAG_CONSTRAINT_MARGINS}}}function p(t,e){var n=t.components.getType(e);return h[n]||m}var d={SITE_STRUCTURE:"getSiteStructure",HEADER:"getHeader",FOOTER:"getFooter"},g=n.components.selectors,m={getBoundaries:function(n,i){var r=n.components.getContainer(i);if(c(n,r))return function(t,e){var n=t.components.layout.getRelativeToScreen(e);return{top:{compTopY:n.y},bottom:{compBottomY:n.y+n.height},left:{compLeftX:n.x},right:{compRightX:n.x+n.width}}}(n,r);var s=l(n);if(!e.isShownOnAllPagesComponent(n,i))return t.assign(s.bottom,{compBottomY:5e5}),s;var p=o(n,d.FOOTER);if(t.assign(s.bottom,{compBottomY:p.y+p.height}),a(n,r)){var g=o(n,d.HEADER);return t.assign(s.bottom,{compBottomY:g.height}),s}return u(n,r)&&t.assign(s.top,{compTopY:p.y}),s},getConstraintArea:function(n,i){var l=n.components.getContainer(i),p=o(n,d.SITE_STRUCTURE);return c(n,l)?function(e,n,i){var s=o(e,d.HEADER),a={left:s.x,width:s.width,height:s.height,top:s.y},u=e.components.layout.getRelativeToScreen(i),c=t.assign(r(n,u),{top:n.y+u.height+u.y});return t.concat(a,c)}(n,p,l):e.isShownOnAllPagesComponent(n,i)?a(n,l)?s(n,p):u(n,l)?function(e,n){var i=o(e,d.FOOTER);return t.assign(r(n,i),{bottom:n.y+i.y})}(n,p):null:null}},h={"wysiwyg.viewer.components.HeaderContainer":{getBoundaries:function(e,n){var o=e.documentServices.components.getChildren(t.isArray(n)?n[0]:n),r=l(e);return t.isEmpty(o)?r:t.assign(r,{top:{compBottomY:i.SIZE_LIMITS.MOBILE_HEADER_MIN_HEIGHT}})},getConstraintArea:function(){return null}},"wysiwyg.viewer.components.mobile.TinyMenu":{getBoundaries:function(t){var e=o(t,d.SITE_STRUCTURE),n=o(t,d.HEADER);return{top:{compTopY:e.y},bottom:{compBottomY:n?Math.min(n.height,i.SIZE_LIMITS.FIXED_TINY_MENU_MAX_Y):i.SIZE_LIMITS.FIXED_TINY_MENU_MAX_Y},left:{compLeftX:e.x},right:{compRightX:e.x+e.width}}},getConstraintArea:function(e){var n=o(e,d.SITE_STRUCTURE),r=o(e,d.HEADER),a=s(e,n);return t.assign(a,{top:n.y+Math.min(i.SIZE_LIMITS.FIXED_TINY_MENU_MAX_Y,r.height)}),a}}};return{shouldConstrain:function(t){return t.isMobileEditor()},getConstraintArea:function(t,e){return p(t,e).getConstraintArea(t,e)},getBoundaries:function(t,e){return p(t,e).getBoundaries(t,e)}}}),define("core/utils/layoutConstraintsUtil/layoutConstraints/desktopBoundariesConstraints",["lodash","core/utils/layoutConstraintsUtil/layoutConstraints/constraintsUtil","experiment"],function(t,e,n){"use strict";function i(t,i){var s={};return s.top=n.isOpen("removeDesktopTopConstraintExp")?{compBottomY:o}:{compTopY:0},t.isCurrentPageLandingPage()||(s.bottom={compBottomY:function(t,n){if(e.isShownOnAllPagesComponent(t,n)&&(!t.siteSegments.isUsingSectionsLayout()||!function(t,e){var n=t.siteSegments.getSiteStructure();return t.utils.isSameRef(t.components.getContainer(e),n)}(t,n))){var i=t.components.layout.getRelativeToScreen(t.documentServices.siteSegments.getFooter());return i.y+i.height}return r}(t,i)}),s}var o=20,r=5e5;return{shouldConstrain:function(t){return!t.isMobileEditor()},getBoundaries:i}}),define("core/utils/layoutConstraintsUtil/layoutConstraints/repeaterElementsBoundariesConstraints",["stateManagement"],function(t){"use strict";var e=t.components.selectors;return{shouldConstrain:function(t,n){return t.isMobileEditor()&&t.components.is.descendantOfRepeaterItem(n)&&!e.isRepeaterItem(n,t.documentServices)},getBoundaries:function(t,e){var n=t.components.getAncestorRepeaterItem(e),i=t.components.layout.getRelativeToScreen(n);return{top:{compTopY:i.y},bottom:{compBottomY:i.y+i.height}}}}}),define("core/utils/layoutConstraintsUtil/editorConstraintsRegistry",["core/utils/layoutConstraintsUtil/layoutConstraints/stretchToScreenConstraints","core/utils/layoutConstraintsUtil/layoutConstraints/mobileBoundariesConstraints","core/utils/layoutConstraintsUtil/layoutConstraints/desktopBoundariesConstraints","core/utils/layoutConstraintsUtil/layoutConstraints/repeaterElementsBoundariesConstraints"],function(t,e,n,i){"use strict";return[t,e,n,i]}),define("core/utils/layoutConstraintsUtil/EditorLayoutConstraintsUtil",["core/utils/layoutConstraintsUtil/LayoutConstraintsUtil","core/utils/layoutConstraintsUtil/editorConstraintsRegistry"],function(t,e){"use strict";function n(n,i){t.call(this,n,i,e)}return n.prototype=t.prototype,n}),define("core/utils/updateLayoutUtil",["lodash","core/utils/layoutConstraintsUtil/EditorLayoutConstraintsUtil"],function(t,e){"use strict";function n(e,n,i,o){if(!e)return e;var r=t.pick(e,["width","height"]);return t.isNumber(e.x)&&(r.x=n.x+e.x,i&&(r.x+=o)),t.isNumber(e.y)&&(r.y=n.y+e.y),r}function i(e,n){return t.some(e,function(e,i){return!t.isEqual(e,n[i])})}function o(o,r,s,a){if(i(s,a)&&!o.utils.isPage(r)){var u=new e(o,r);if(u.hasConstraints()){var c=o.components.layout.isHorizontallyStretchedToScreen(r),l=o.site.getSiteX(),p=function(t,e){var n=t.components.getContainer(e);return t.components.layout.getRelativeToScreen(n)}(o,r),d=n(s,p,c,l),g=n(a,p,c,l);u.applyConstraints(o,r,d,g);var m=function(e,n,i,o){if(!e)return e;var r=t.pick(e,["width","height"]);return t.isNumber(e.x)&&(r.x=e.x-n.x,i&&(r.x-=o)),t.isNumber(e.y)&&(r.y=e.y-n.y),r}(d,p,c,l);t.assign(s,t.pick(m,t.keys(s)))}}return s}return{getLayoutAfterConstraints:o,resetCompLayoutToAspectRatio:function(e,n,i){var o=e.components.layout.getRelativeToStructure(n),r=t.pick(o,["x","y","width","height"]),s=Math.max(r.width,r.height);i<1?(r.height=s,r.width=r.height*i):(r.width=s,r.height=r.width/i),r.x=o.x+(o.width-r.width)/2,r.y=o.y+(o.height-r.height)/2,e.components.layout.updateRelativeToStructure(n,r,!0)},getLayoutRelativeToScreenAfterConstraints:function(t,n,o,r){if(i(o,r)&&!t.utils.isPage(n)){var s=new e(t,n);s.hasConstraints()&&s.applyConstraints(t,n,o,r)}return o}}}),define("core/utils/addComponentPlugins/plugins/vectorImageAfter",["lodash","core/utils/updateLayoutUtil"],function(t,e){"use strict";return function(t,n){var i=t.components.properties.get(n);if("fit"===i.displayMode||"legacyFit"===i.displayMode){var o=t.media.vectorImage.getSvgOriginalAspectRatio(n);e.resetCompLayoutToAspectRatio(t,n,o)}}}),define("core/utils/addComponentPlugins/plugins/wTwitterTweet",[],function(){"use strict";return function(t,e,n,i){i.data.urlFormat=t.documentServices.generalInfo.urlFormat.get()}}),define("core/utils/addComponentPlugins/addComponentPlugins",["core/utils/addComponentPlugins/plugins/page","core/utils/addComponentPlugins/plugins/anchor","core/utils/addComponentPlugins/plugins/documentMedia","core/utils/addComponentPlugins/plugins/audioPlayer","core/utils/addComponentPlugins/plugins/singleAudioPlayer","core/utils/addComponentPlugins/plugins/contactForm","core/utils/addComponentPlugins/plugins/clipArt","core/utils/addComponentPlugins/plugins/svgShape","core/utils/addComponentPlugins/plugins/wPhoto","core/utils/addComponentPlugins/plugins/verticalAnchorsMenu","core/utils/addComponentPlugins/plugins/stripContainer","core/utils/addComponentPlugins/plugins/appControllerAddPlugin","core/utils/addComponentPlugins/plugins/vectorImageBefore","core/utils/addComponentPlugins/plugins/vectorImageAfter","core/utils/addComponentPlugins/plugins/wTwitterTweet"],function(t,e,n,i,o,r,s,a,u,c,l,p,d,g,m){"use strict";return{before:{"mobile.core.components.Page":t,"wysiwyg.common.components.anchor.viewer.Anchor":e,"wysiwyg.viewer.components.documentmedia.DocumentMedia":n,"wysiwyg.viewer.components.AudioPlayer":i,"wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer":o,"wysiwyg.viewer.components.ClipArt":s,"wysiwyg.viewer.components.ContactForm":r,"wysiwyg.viewer.components.DynamicContactForm":r,"wysiwyg.viewer.components.svgshape.SvgShape":a,"wysiwyg.viewer.components.WPhoto":u,"wysiwyg.viewer.components.StripContainer":l,"wysiwyg.common.components.verticalanchorsmenu.viewer.VerticalAnchorsMenu":c,"wysiwyg.viewer.components.WTwitterTweet":m,"wysiwyg.viewer.components.VectorImage":d},after:{"platform.components.AppController":p,"wysiwyg.viewer.components.VectorImage":g}}}),define("core/utils/addUtil",["core/utils/addComponentPlugins/addComponentPlugins","core/utils/updateDataPlugins/updateDataPlugins"],function(t,e){"use strict";return{addComponent:function(n,i,o,r,s,a,u){var c=r.componentType,l=r.data&&r.data.type;if(e[l]&&(r.data=e[l](r.data)),t.before[c]){var p=t.before[c](n,i,o,r,s,a);if(p)return p}var d=i(o,r,s);return n.documentServices.waitForChangesApplied(function(){a&&a(d),t.after[c]&&t.after[c](n,d,u)}),d},componentsWithPlugins:Object.keys(t)}}),define("core/bi/bi",["coreBi"],function(t){"use strict";return{events:t.events,errors:t.errors,registerEvents:t.registerEvents}}),define("core/utils/scrollUtils",["lodash"],function(t){"use strict";function e(){return window.document.getElementById("scrollableEditorStage")}return{getScroll:function(){var n=e();return t.pick(n,["scrollLeft","scrollTop","scrollHeight","scrollWidth"])},setScroll:function(n){var i=e();t.isUndefined(n.scrollTop)||(i.scrollTop=n.scrollTop),t.isUndefined(n.scrollLeft)||(i.scrollLeft=n.scrollLeft)}}}),define("core/utils/stageUtils",["lodash","uiConstants","core/utils/scrollUtils"],function(t,e,n){"use strict";var i={top:e.VIEWPORT_VERTICAL_MARGINS,bottom:e.VIEWPORT_VERTICAL_MARGINS,left:72,right:60},o={getViewPort:function(t,e){var r=o.getStageLayout();if(!r)return null;var s=n.getScroll(),a={y:i.top,minY:i.top,bottomY:r.height-i.bottom,maxBottomY:s.scrollHeight-i.bottom,marginBottom:i.bottom,x:i.left,rightX:r.width-i.right,height:r.height-(i.top+i.bottom),width:r.width-(i.left+i.right),scrollTop:s.scrollTop,scrollLeft:s.scrollLeft,stageLayout:r};t&&(a.y+=s.scrollTop,a.bottomY+=s.scrollTop,a.x+=s.scrollLeft,a.rightX+=s.scrollLeft);var u=e&&e.right+10;if(u&&u>a.x){var c=u-a.x;a.x=u,a.width-=c}return a},getStageLayout:function(){var t=window.document.getElementById("stageContainer");return t?t.getBoundingClientRect():{x:0,y:0,width:0,height:0}},getStageRect:function(){var t=o.getStageLayout(),e=n.getScroll();return{top:e.scrollTop,bottom:e.scrollTop+t.height,left:e.scrollLeft,right:e.scrollLeft+t.width}}};return o}),define("core/utils/AttachHandler",["lodash"],function(t){"use strict";function e(t,e){return t.components.layout.getRelativeToScreenConsideringScroll(e)}function n(n,i,o){var r=n.documentServices.siteSegments.getHeader(),s=n.documentServices.pages.getFocusedPageId(),a=n.components.getAllComponents(s);(function(t){return t.isMobileEditor()})(n,i.comp)&&(a=a.concat(n.documentServices.siteSegments.getSiteStructure()));return o===l.COMP&&(!n.components.isShowOnAllPages(i.comp)||n.siteSegments.isUsingSectionsLayout()&&function(t,e){var n=t.siteSegments.getSiteStructure();return t.utils.isSameRef(t.components.getContainer(e),n)}(n,i.comp))&&(a=function(e,n){var i=e.documentServices.siteSegments.getFooter();return t.filter(n,function(t){var n=e.components.isDescendantOfComp(t,i);return!e.utils.isSameRef(t,i)&&!n})}(n,a)),t(a).filter(function(t){return!n.utils.isSameRef(t,i.comp)&&p[o].isContainable(n,i.comp,t)}).filter(function(t){return n.components.isRenderedOnSite(t)}).map(function(t){return{layout:e(n,t),comp:t}}).filter(function(t){var e=n.utils.isSameRef(t.comp,r);return t.layout.width>=i.layout.width&&(e||t.layout.height>=i.layout.height)}).value()}function i(t,e,n,i){var o=t.components.is.fullWidth(e),r=t.utils.isSameRef(e,t.documentServices.siteSegments.getHeader());return(o||n.x>=i.x)&&(o||n.x+n.width<=i.x+i.width)&&(r||n.y>=i.y)&&n.y+n.height<=i.y+i.height}function o(e,n){var o=n.layout,r=n.comp,s=e.layout,a=p[this.type].getContainer(this.editorAPI,this.comp);return!(t.isEmpty(a)&&this.editorAPI.utils.isSiteStructure(r))&&!function(e,n,i){return!t.isEmpty(n)&&e.utils.isSiteStructure(n)&&e.utils.isPage(i)}(this.editorAPI,a,r)&&!function(e,n,i){return!t.isEmpty(n)&&!e.components.isShowOnAllPages(n)&&e.utils.isSiteStructure(i)}(this.editorAPI,a,r)&&!function(e,n,i){return!t.isEmpty(n)&&!e.components.isShowOnAllPages(n)&&"wysiwyg.viewer.components.FooterContainer"===e.components.getType(i)}(this.editorAPI,a,r)&&!this.editorAPI.utils.isSameRef(a,r)&&i(this.editorAPI,n.comp,s,o)}function r(t,e){return!(t.x>=e.x+e.width||e.x>=t.x+t.width||t.y>=e.y+e.height||e.y>=t.y+t.height)}function s(s,a){t.has(this,"attachCandidates")||(this.attachCandidates=n(this.editorAPI,this.initialCompWithLayout,this.type));var u=t.find(this.attachCandidates,t.bind(function(t){return t.layout=function(t,n,i){return t.components.is.repeatedComponent(i)?e(t,n.comp):n.layout}(this.editorAPI,t,this.comp),a?i(this.editorAPI,t.comp,s,t.layout):r(s,t.layout)},this));return u&&o.call(this,{layout:s},u)?u.comp:null}function a(e,n){var i=e||p[this.type].getCompLayout(this.editorAPI,this.comp),o=function(e){var n=p[this.type].getContainer(this.editorAPI,this.comp);return!(!t.isEmpty(n)&&p[this.type].getCompLayout&&r(e,p[this.type].getCompLayout(this.editorAPI,n)))}.call(this,i),a=s.call(this,i,o),u=t.find(n,t.isEqual.bind(t,a));return a&&!u?a:function(t,e,n,i){var o=p[i].getContainer(t,n);return!t.utils.isPage(o)&&(t.isMobileEditor()?e&&!p[i].isShowOnAllPages(t,n):e)}(this.editorAPI,o,this.comp,this.type)?this.editorAPI.pages.getFocusedPage():null}function u(e){(e=function(e,n,i){var o,r=e.documentServices.pages.popupPages.getCurrentPopupId();if(r)if(i){if(i.id===r)return null}else if(o=e.pages.popupPages.getPopupContainer(),t.find(n,["comp.id",o.id]))return o;return i}(this.editorAPI,this.attachCandidates,e))&&this.editorAPI.utils.isSiteStructure(e)||this.editorAPI.setAttachCandidate(e,this.type===l.STRUCTURE)}function c(t,e,i){t&&(this.editorAPI=t,this.type=i,this.initialCompWithLayout=e,this.comp=e.comp,this.attachCandidates=n(t,e,i))}var l={COMP:"comp",STRUCTURE:"structure"},p={comp:{getContainer:function(t,e){return t.components.getContainer(e)},isContainable:function(t,e,n){return t.components.is.containable(e,n)&&!t.components.is.group(n)},getCompLayout:function(t,e){return t.components.layout.getRelativeToScreenConsideringScroll(e).bounding},getCompType:function(t,e){return t.components.getType(e)},isShowOnAllPages:function(t,e){return t.components.isShowOnAllPages(e)}},structure:{getCompType:function(){return""},getContainer:function(){return{}},isContainable:function(t,e,n){return t.components.is.containableByStructure(e,n)&&!t.components.is.group(n)},isShowOnAllPages:function(){return!1}}};return c.prototype={getCurrentAttachCandidate:a,highlightAttachCandidate:u,clearHighlightAttachCandidate:function(t){this.editorAPI.setAttachCandidate(null,!!t)}},c.TYPES=l,c}),define("core/utils/mouseCoordinatesHandler",["core/utils/stageUtils","lodash"],function(t,e){"use strict";return{fitMouseCoordinatesToViewer:function(n,i){var o=n.getSiteScale(),r=t.getStageLayout(),s=r.width*(1-o)/2,a=n.ui.scroll.getScroll(),u=e.pick(i,["pageX","pageY","clientX","clientY"]);u.originalPageX=u.pageX,u.originalPageY=u.pageY,u.originalClientX=u.clientX,u.originalClientY=u.clientY,u.pageX+=a.scrollLeft,u.pageY+=a.scrollTop;var c=n.getPreviewPosition();return u.clientX-=c.left,u.clientY-=c.top,u.pageX-=c.left,u.pageY-=c.top,o&&1!==o&&function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom}(r,u.clientX,u.clientY)&&(u.pageX=(u.pageX-s)/o,u.pageY/=o,u.clientX=(u.clientX-s)/o,u.clientY/=o),u}}}),define("core/utils/mediaManagerPresetUtil",["lodash"],function(t){"use strict";function e(n){var i=t.get(n,"data",{});switch(i.type){case"VectorImage":return i.svgId;case"Image":return i.uri;case"WixVideo":return(i=t.get(n,"design",{})).videoId||"";case"BackgroundMedia":return i=t.get(n,"design",{}),e(i.mediaRef)||"";default:return""}}return{getIdByDataType:e,storePath:function(t,e,n){n&&t.getUserPreferences().session.set("last_media_path_"+e,n)},getPath:function(t,e){return t.getUserPreferences().session.get("last_media_path_"+e)||""}}}),define("core/utils/gridLinesUtil",[],function(){"use strict";return{getPageGridLines:function(t,e){return function(t,e){var n=t.y+t.height,i=t.x+t.width,o={x1:t.x,y1:0,x2:t.x,y2:"100%"},r={x1:i,y1:0,x2:i,y2:"100%"},s={x1:0,y1:t.y,x2:"100%",y2:t.y};return e?[o,r]:[o,r,s,{x1:0,y1:n,x2:"100%",y2:n}]}(function(t){var e=t.siteSegments.getPagesContainerAbsLayout(),n=t.getSiteScale();if(!n||1===n)return e;var i={y:e.y*n,width:e.width*n,height:e.height*n},o=e.width-i.width;return i.x=e.x+o/2,i}(t),e)},getContainerGridLines:function(t,e){"wysiwyg.viewer.components.StripColumnsContainer"===t.components.getType(e)&&(e=t.components.getChildren(e)[0]);var n=t.components.layout.getCompMargin(e),i=t.components.layout.getRelativeToScreen(e),o=i.y+i.height,r=i.x+n.left,s=i.x+i.width-n.right;return[{x1:r,y1:i.y,x2:r,y2:o},{x1:s,y1:i.y,x2:s,y2:o}]}}}),define("core/utils/SnapToHandler",["lodash","core/utils/stageUtils","core/utils/gridLinesUtil"],function(t,e,n){"use strict";function i(e,n,i,o){return n||t.isEqual(i,e)||t.isEqual(o,e)}function o(t,e,n,o,r){var s=i(e,n,o,r);return t.components.layout.getRelativeToScreen(e,s).bounding}function r(t,e){return e&&t.components.is.page(e)}function s(i,s){var a=i.documentServices.siteSegments.getHeader(),u=i.documentServices.siteSegments.getFooter();return t(s).map(function(e){var n=r(i,e);return{layout:o(i,e,n,a,u),isDynamicLayout:function(e,n,i,o){return i||t.isEqual(o,n)||e.components.isDescendantOfComp(n,o)}(i,e,n,u),comp:e}}).concat(function(n){if(!n.rulers.isRulersEnabled())return[];var i=function(n){var i=n.rulers.getHorizontalGuides(),o=e.getStageRect();return t.map(i,function(t){return{id:t.guideId,x:o.left,y:t.guidePosition,height:0,width:o.right}})}(n);return i=i.concat(function(n){var i=n.rulers.getVerticalGuides(),o=e.getStageRect();return t.map(i,function(t){var e=n.rulers.getVerticalGuideRealPosition(t.guidePosition);return{id:t.guideId,x:e,y:o.top,height:o.bottom,width:0}})}(n)),t.map(i,function(t){return{layout:t,isDynamicLayout:!1}})}(i)).concat(function(e){var i=e.selection.getFocusedContainer();if(!i||!e.components.is.showMarginsIndicator(i))return[];return t(i).thru(n.getContainerGridLines.bind(null,e)).map(function(t){return{layout:{x:t.x1,y:t.y1,height:t.y2-t.y1,width:0},isDynamicLayout:!1}}).value()}(i)).value()}function a(t){var e=t.layout;return this.right>=e.x&&e.x+e.width>=this.left&&this.bottom>=e.y&&e.y+e.height>=this.top}function u(n){return t.filter(n,t.bind(a,e.getStageRect()))}function c(e,n,o){var s=e.documentServices.siteSegments.getHeader(),a=e.documentServices.siteSegments.getFooter();return t.filter(o,function(t){var o=t.comp,u=r(e,o),c=t.layout;return!i(o,u,s,a)&&(n===c.y||n===c.y+c.height)})}function l(e,n,o){var s=e.documentServices.siteSegments.getHeader(),a=e.documentServices.siteSegments.getFooter();return t.filter(o,function(t){var o=t.comp,u=r(e,o),c=t.layout;return!i(o,u,s,a)&&(n===c.x||n===c.x+c.width)})}function p(e,n){return t.map(n,function(n){return t(n.layout).pick(["x","y","width","height"]).assign({isOnMasterPage:n.comp&&(e.components.isShowOnAllPages(n.comp)||e.components.isShowOnSomePages(n.comp))}).value()})}function d(e,n,i,o,r){var s=t.map(o,"layout"),a=[i].concat(s),u=function(e){return t.minBy(e,"x")}(a.concat(r)),c=function(e){return t.maxBy(e,function(t){return t.x+t.width})}(a.concat(r)),l=p(e,o);return{line:[{x:u.x,y:n},{x:c.x+c.width,y:n}],rectanglesDrawData:l}}function g(e,n,i,o,r){var s=t.map(o,"layout"),a=[i].concat(s),u=function(e){return t.minBy(e,"y")}(a.concat(r)),c=function(e){return t.maxBy(e,function(t){return t.y+t.height})}(a.concat(r)),l=p(e,o);return{line:[{x:n,y:u.y},{x:n,y:c.y+c.height}],rectanglesDrawData:l}}function m(e,n){var i=e.documentServices.pages.getFocusedPageId();return e.components.getAllComponents(i,function(e,n,i){return!(e.selection.isComponentSelected(i)||e.components.is.groupedComponent(i)||t.includes(P,i.id)||!e.components.isRenderedOnSite(i)||e.components.layout.isRenderedInFixedPosition(i)||n&&e.components.isAscendantOfComp(n,i))}.bind(null,e,n))}function h(t,e){t&&(this.editorAPI=t,this.compRefs=e)}function f(i,o){var r=function(i){var o=e.getStageRect().right;return t(i).thru(n.getPageGridLines).filter({x2:"100%"}).map(function(t){return{x:t.x1,y:t.y1,width:o}}).value()}(i);return t.filter(r,{y:o})}function y(i,o){var r=function(i){var o=e.getStageRect().bottom;return t(i).thru(n.getPageGridLines).filter({y2:"100%"}).map(function(t){return{x:t.x1,y:t.y1,height:o}}).value()}(i);return t.filter(r,{x:o})}var P=["SITE_PAGES","PAGES_CONTAINER"];return h.prototype.getSnapCandidates=function(){if(!t.has(this,"snapCandidates")){var e=m(this.editorAPI,this.compRefs);this.snapCandidates=s(this.editorAPI,e),this.compRefs=null}return this.snapCandidates},h.prototype.getClosestLayoutDistance=function(e,n,s){var a=this.getSnapCandidates();!function(e,n){t.forEach(n,function(t){t.layout=t.isDynamicLayout?o(e,t.comp):t.layout})}(e,a);var c=u(a);return{x:function(e,n,o,s){var a=e.documentServices.siteSegments.getHeader(),u=e.documentServices.siteSegments.getFooter(),c=t.reduce(o,function(t,o){var c=o.layout,l=o.comp;return i(l,r(e,l),a,u)||(s.left&&(t.push(c.x-n.x),t.push(c.x+c.width-n.x)),s.right&&(t.push(c.x-(n.x+n.width)),t.push(c.x+c.width-(n.x+n.width)))),s.centerX&&t.push((c.x+(c.x+c.width))/2-(n.x+(n.x+n.width))/2),t},[]),l=function(t,e,n){var i=t.siteSegments.getPagesContainerAbsLayout(),o=[];return n.left&&(o.push(i.x-e.x),o.push(i.x+i.width-e.x)),n.right&&(o.push(i.x-(e.x+e.width)),o.push(i.x+i.width-(e.x+e.width))),o}(e,n,s);return t.minBy(c.concat(l),function(t){return Math.abs(t)})}(e,n,c,s),y:function(e,n,o,s){var a=e.documentServices.siteSegments.getHeader(),u=e.documentServices.siteSegments.getFooter(),c=t.reduce(o,function(t,o){var c=o.layout,l=o.comp;return i(l,r(e,l),a,u)||(s.top&&(t.push(c.y-n.y),t.push(c.y+c.height-n.y)),s.bottom&&(t.push(c.y-(n.y+n.height)),t.push(c.y+c.height-(n.y+n.height)))),s.centerY&&t.push((c.y+(c.y+c.height))/2-(n.y+(n.y+n.height))/2),t},[]),l=function(t,e,n){var i=t.siteSegments.getPagesContainerAbsLayout(),o=[];return n.top&&(o.push(i.y-e.y),o.push(i.y+i.height-e.y)),n.bottom&&(o.push(i.y-(e.y+e.height)),o.push(i.y+i.height-(e.y+e.height))),o}(e,n,s);return t.minBy(c.concat(l),function(t){return Math.abs(t)})}(e,n,c,s)}},h.prototype.getSnapData=function(e,n){var i=[],o=u(this.getSnapCandidates()),r=[],s=[],a=n.centerY&&function(e,n){return t.filter(n,function(t){var n=t.layout;return e===(n.y+(n.y+n.height))/2})}((e.y+e.y+e.height)/2,o);if(a&&a.length>0)i.push(d(this.editorAPI,(e.y+e.y+e.height)/2,e,a,r));else{var p=[];if(n.top&&(p=c(this.editorAPI,e.y,o),r=f(this.editorAPI,e.y),(p.length>0||r.length>0)&&i.push(d(this.editorAPI,e.y,e,p,r))),n.bottom){var m=e.y+e.height;p=c(this.editorAPI,m,o),r=f(this.editorAPI,m),(p.length>0||r.length>0)&&i.push(d(this.editorAPI,m,e,p,r))}}var h=n.centerX&&function(e,n){return t.filter(n,function(t){var n=t.layout;return e===(n.x+(n.x+n.width))/2})}((e.x+e.x+e.width)/2,o);if(h&&h.length>0)i.push(g(this.editorAPI,(e.x+e.x+e.width)/2,e,h,s));else{var P=[];if(n.right){var v=e.x+e.width;P=l(this.editorAPI,v,o),s=y(this.editorAPI,v),(P.length>0||s.length>0)&&i.push(g(this.editorAPI,v,e,P,s))}n.left&&(P=l(this.editorAPI,e.x,o),s=y(this.editorAPI,e.x),(P.length>0||s.length>0)&&i.push(g(this.editorAPI,e.x,e,P,s)))}return i},h}),define("core/utils/AddPanelDragHandler",["lodash","jquery","experiment","constants","core/bi/bi","core/utils/stageUtils","core/utils/AttachHandler","core/utils/mouseCoordinatesHandler","core/utils/mediaManagerPresetUtil","core/utils/SnapToHandler"],function(t,e,n,i,o,r,s,a,u,c){"use strict";function l(e,s,a,u,c,l,g){e&&(this.editorAPI=e,this.initialEvent=s,this.item=a,this.panelElm=u,this.dragBoxClass=c,this.onItemDragStart=l,this.onItemDragEnd=g,this.isFirstDragEvent=!0,this.originalDragPosition={x:this.initialEvent.pageX,y:this.initialEvent.pageY},this.item.onDrop=this.item.onDrop||function(e,r,s,a){t.assign(s.structure.layout,r),e.components.add(a,s.structure,void 0,function(r){if(!t.isEmpty(e.components.modes.getModes(a))&&r.id){var u=e.components.modes.getComponentActiveModeIds(a);e.components.modes.showComponentOnlyInModesCombination(r,t.keys(u)),e.tabIndicationState.activateAddAnimation(!0),e.components.modes.addDefaultSingleModeAnimations(r)}"Page"!==s.structure.type&&e.history.add("component dragged to stage from add panel");var c=e.components.getType(a),l=e.components.is.repeatedComponent(a);if(e.selection.selectComponentByCompRef(r),e.openFirstTimePanel(r),e.bi.event(o.events.addPanel.COMPONENT_ADDED_TO_STAGE,{origin:"add_panel",category:s.categoryId,section:s.sectionTitle,component_type:s.structure.componentType,component_id:r.id,preset_id:s.itemId||"",adding_method:"drag",preset_data_skin:s.structure.style.skin||s.structure.skin||s.structure.style,preset_data_tags:s.tags||"",page_id:e.pages.getFocusedPage()&&e.pages.getFocusedPage().id,target_component:c,is_target_repeated:l}),e.openCompOutOfGridPanelIfNeeded(r),n.isOpen("se_santaMembers")&&s.appDefinitionId){var p=e.documentServices.platform.getAppDataByAppDefId(s.appDefinitionId);e.documentServices.platform.notifyApplication(p.applicationId,{eventType:i.EVENTS.ADD_PANEL.COMPONENT_ADDED_TO_STAGE,eventPayload:{compRef:r}})}})}.bind(null,this.editorAPI),this.stageLayout=r.getStageLayout(),this.editorAPI.components.is.fullWidthByStructure(this.item.structure)?(this.isFullWidth=!0,this.allowedSnapDirections=d):(this.allowedSnapDirections=p,this.isFullWidth=!1),this.init())}var p={top:!0,bottom:!0,left:!0,right:!0,centerX:!0,centerY:!0},d={top:!0,bottom:!0,left:!1,right:!1,centerX:!1,centerY:!0},g=8;return l.prototype={init:function(){this.snapToHandler=new c(this.editorAPI),this.attachHandler=new s(this.editorAPI,{comp:this.item.structure,layout:t.pick(this.item.structure.layout,["width","height"])},s.TYPES.STRUCTURE)},getFixedDragPosition:function(t){return{x:t.clientX,y:t.clientY}},onDrag:function(t){var e=a.fitMouseCoordinatesToViewer(this.editorAPI,t);if(this.isFirstDragEvent){if(!function(t,e){return Math.abs(e.x-t.pageX)>=g||Math.abs(e.y-t.pageY)>=g}(e,this.originalDragPosition))return;this.onInitialDrag(),this.isFirstDragEvent=!1}this.lastDragPosition={x:e.pageX,y:e.pageY},this.lastDragFixedPosition=this.getFixedDragPosition(t);var n=this.isInPanelArea();n?this.handleDragInPanelArea():this.handleDragOutsidePanelArea(t),this.setDragBox(n)},onInitialDrag:function(){t.isFunction(this.onItemDragStart)&&this.onItemDragStart()},isInPanelArea:function(){var t=this.getPanelClientRect();return this.lastDragFixedPosition.x>=t.left&&this.lastDragFixedPosition.x<=t.right&&this.lastDragFixedPosition.y>=t.top&&this.lastDragFixedPosition.y<=t.bottom},getPanelClientRect:function(){return this._panelClientRect||(this._panelClientRect=this.panelElm.getBoundingClientRect()),this._panelClientRect},handleDragOutsidePanelArea:function(){var t,e=this.getDragBoxStageLayout(),n=this.getDragBoxStageLayout(!0);"popup"!==this.item.categoryId&&(this.snapDragBoxToCompIfNeeded(e),t=this.attachHandler.getCurrentAttachCandidate(n),this.attachHandler.highlightAttachCandidate(t||this.editorAPI.pages.getFocusedPage()))},handleDragInPanelArea:function(){this.editorAPI.snapData.clear(!0),this.attachHandler.clearHighlightAttachCandidate(!0)},getDragBoxStageLayout:function(t){var e={x:this.lastDragPosition.x+this.getBoxOffset().left*this.item.structure.layout.width,y:this.lastDragPosition.y+this.getBoxOffset().top*this.item.structure.layout.height,width:this.item.structure.layout.width,height:this.item.structure.layout.height};if(t){var n=this.editorAPI.ui.scroll.getScroll();e.x-=n.scrollLeft,e.y-=n.scrollTop}return e},getBoxOffset:function(){if(!this._boxOffset){var t=this.getRectSize();this._boxOffset={left:(this.item.rect.left+e(window).scrollLeft()-this.originalDragPosition.x)/t.width,top:(this.item.rect.top+e(window).scrollTop()-this.originalDragPosition.y)/t.height}}return this._boxOffset},getRectSize:function(){return{width:this.item.rect.width,height:this.item.rect.height}},setDragBox:function(e){var n={key:"dragToStageDragBox",coords:{left:this.lastDragFixedPosition.x,top:this.lastDragFixedPosition.y},boxOffset:this.getBoxOffset()};if(e)n.boxSize=this.getRectSize();else if("popup"===this.item.categoryId)(n=function(e,n,i){var o=n.structure.components[0],r=o.layout,s=o.props.alignmentType,a=o.props.verticalAlignment,u=o.props.horizontalAlignment,c={fullHeight:function(){return{left:"left"===u?i.left:i.right-r.width,top:i.top,height:i.height,width:r.width}},fullWidth:function(){return{left:i.left,top:"bottom"===a?i.bottom-r.height:i.top,height:r.height,width:i.width}},nineGrid:function(){return{left:(i.width-r.width)/2,top:(i.height-r.height)/2,height:r.height,width:r.width}}}[s]();return e.coords=t.pick(c,["left","top"]),e.boxSize=t.pick(c,["height","width"]),e.boxOffset={left:0,top:0},e}(n,this.item,this.stageLayout)).boxSize.height*=this.editorAPI.getSiteScale();else{n.boxSize=t.pick(this.item.structure.layout,["width","height"]);var i=this.editorAPI.getSiteScale();n.boxSize.height*=i,this.isFullWidth&&(n=function(e,n,i){return e.boxOffset=t.assign({},e.boxOffset,{left:0}),e.coords.left=i.left,n&&(e.boxSize.width=n),e}(n,this.stageLayout.width,this.editorAPI.getPreviewPosition()))}var o={props:n,componentType:this.item.structure.componentType,reactClass:this.dragBoxClass};this.editorAPI.setPortalChildren("addPanel",[o])},snapDragBoxToCompIfNeeded:function(t){var e=this.snapToHandler.getClosestLayoutDistance(this.editorAPI,t,this.allowedSnapDirections);Math.abs(e.x)<=5&&(this.lastDragPosition.x+=e.x,this.lastDragFixedPosition.x+=e.x,t.x+=e.x),Math.abs(e.y)<=5&&(this.lastDragPosition.y+=e.y,this.lastDragFixedPosition.y+=e.y,t.y+=e.y);var n=this.snapToHandler.getSnapData(t,this.allowedSnapDirections);this.editorAPI.snapData.set(n,!0)},clearDrag:function(){this.editorAPI.snapData.clear(!0),this.attachHandler.clearHighlightAttachCandidate(!0)},endDrag:function(t){if(this.clearDrag(),this.editorAPI.setPortalChildren("addPanel",null),this.isFirstDragEvent)return!1;var e=a.fitMouseCoordinatesToViewer(this.editorAPI,t);return this.lastDragPosition={x:e.pageX,y:e.pageY},this.isInPanelArea()||this.onDrop(t),this.onItemDragEnd&&this.onItemDragEnd(),!0},getCompPositionRelativeToContainer:function(t,e){return{x:this.lastDragPosition.x-t.x-e.x+this.getBoxOffset().left*this.item.structure.layout.width,y:this.lastDragPosition.y-t.y-e.y+this.getBoxOffset().top*this.item.structure.layout.height}},onDrop:function(){var e=this.getDropContainer(this.getDragBoxStageLayout(!0)),i=this.editorAPI.components.layout.getRelativeToStructure(e),o=function(t){var e=t.documentServices.siteSegments.getPagesContainer();return{x:t.components.layout.getRelativeToScreen(e).x,y:0}}(this.editorAPI),r=this.getCompPositionRelativeToContainer(o,i);this.item.onDrop&&(t.defer(function(){n.isOpen("se_santaMembers")||n.isOpen("newBlogIntegration")?this.item.onDrop(r,this.item,e,this.editorAPI):this.item.onDrop(r,this.item,e)}.bind(this)),u.storePath(this.editorAPI,u.getIdByDataType(this.item.structure),t.get(this.item,["mediaManager","path"])))},getDropContainer:function(t){var e=this.attachHandler.getCurrentAttachCandidate(t);return e||(e=this.editorAPI.pages.getFocusedPage()),e}},l}),define("core/utils/layoutSymmetryUtil",["lodash"],function(t){"use strict";function e(e){return{horizontal:function(t){return Boolean(t.docked&&t.docked.hCenter||t.symmetry&&t.symmetry.horizontal)}(e)||function(e){var n=t.chain(e).get("docked.left.vw").isFinite().value(),i=t.chain(e).get("docked.right.vw").isFinite().value();return n&&i}(e),vertical:function(t){return Boolean(t.docked&&t.docked.vCenter||t.symmetry&&t.symmetry.vertical)}(e)}}return{getLayoutSymmetry:e}}),define("core/utils/layoutTransitionsUtil",["lodash","core/utils/layoutSymmetryUtil"],function(t,e){"use strict";function n(t,e){return Math.atan2(t.y-e.y,t.x-e.x)}function i(t,e,n){return 0===e?t:{x:(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e)+n.x,y:(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e)+n.y}}function o(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}function r(e,n,i){if(!e)return null;var o=t.clone(e),r=i.x-n.x,s=i.y-n.y;return i.isShiftPressed&&(Math.abs(r)>=Math.abs(s)?s=0:r=0),o.x+=r,o.y+=s,o}function s(e,n,i){e&&(this.initLayout=e,this.boundCompsPositionRelativeToLayout=t.map(i,function(t){return{x:t.x-e.x,y:t.y-e.y}}),this.initMouseLocation=n,this.getLayout=r.bind(null,this.initLayout,this.initMouseLocation),this.getBoundComponentLayouts=function(e,n){return t.map(e,function(t){return{x:n.x+t.x,y:n.y+t.y}})}.bind(null,this.boundCompsPositionRelativeToLayout))}function a(t,e,n,i){var o=0,r=n?Math.floor(e/2):e;return 1===t?o=Math.max(-r,i):-1===t&&(o=Math.min(r,i)),o}function u(n,r,s,u,c){n&&(this.initLayout=n,this.initMouseLocation=r,this.direction=s,this.proportional=u,this.rotationInRad=l*n.rotationInDegrees,this.ratio=c||1,this.initLayoutAspectRatio=n.width/n.height,this.getCorrectXYAfterTransformOriginChange=function(e){var n=t.pick(e,["x","y"]);return n=i(n,-this.rotationInRad,o(e)),i(n,this.rotationInRad,o(this.initLayout))},this.getLayoutAfterProportionalHorizontalResize=function(e,n){var i,o=t.clone(e);this.direction.x===p.LEFT?(i=-Math.min(n.x,e.width),o.x-=i):this.direction.x===p.RIGHT&&(i=Math.max(n.x,-e.width)),o.width+=i,o.height=o.width/this.initLayoutAspectRatio;var r=o.height-this.initLayout.height;return o.y-=r/2,t.assign(o,this.getCorrectXYAfterTransformOriginChange(o)),o},this.getLayoutAfterProportionalVerticalResize=function(e,n){var i=t.clone(e),o=0;this.direction.y===p.TOP?(o=-Math.min(n.y,e.height),i.y-=o):this.direction.y===p.BOTTOM&&(o=Math.max(n.y,-e.height)),i.height+=o,i.width=i.height*this.initLayoutAspectRatio;var r=i.width-this.initLayout.width;return i.x-=r/2,t.assign(i,this.getCorrectXYAfterTransformOriginChange(i)),i},this.getLayoutAfterStandardResize=function(n,i){var o=e.getLayoutSymmetry(n);return this.direction.x&&(o.horizontal?function(t,e,n){var i=a(n,t.width,!0,e.x);1===n?(t.x-=i,t.width+=2*i):-1===n&&(t.x+=i,t.width-=2*i)}(n,i,this.direction.x):(i.x/=this.ratio,function(t,e,n){var i=a(n,t.width,!1,e.x);1===n?t.width+=i:-1===n&&(t.x+=i,t.width-=i)}(n,i,this.direction.x))),this.direction.y&&(o.vertical?function(t,e,n){var i=a(n,t.height,!0,e.y);1===n?(t.y-=i,t.height+=2*i):-1===n&&(t.y+=i,t.height-=2*i)}(n,i,this.direction.y):(i.y/=this.ratio,function(t,e,n){var i=a(n,t.height,!1,e.y);1===n?t.height+=i:-1===n&&(t.y+=i,t.height-=i)}(n,i,this.direction.y))),t.assign(n,this.getCorrectXYAfterTransformOriginChange(n)),this.direction.x||delete n.width,this.direction.y||delete n.height,n},this.getLayout=function(e){var n,o=t.cloneDeep(this.initLayout),r={x:e.x-this.initMouseLocation.x,y:e.y-this.initMouseLocation.y};return r=function(t,e){return i(t,e,{x:0,y:0})}(r,-this.rotationInRad),this.proportional?(!function(t){return t.y===p.NONE&&t.x!==p.NONE}(this.direction)?!function(t){return t.x===p.NONE&&t.y!==p.NONE}(this.direction)?(r=function(t,e,n){var i={x:n.x>0?e.x:e.x+e.width,y:n.y>0?e.y:e.y+e.height},o={x:n.x<0?e.x:e.x+e.width,y:n.y<0?e.y:e.y+e.height},r=(o.y-i.y)/(o.x-i.x),s=r,a=-1,u=i.y-r*i.x,c={x:o.x+t.x,y:o.y+t.y};return{x:(a*(a*c.x-s*c.y)-s*u)/(s*s+1)-o.x,y:(s*(s*c.y-a*c.x)-a*u)/(s*s+1)-o.y}}(r,o,this.direction),n=this.getLayoutAfterStandardResize(o,r)):n=this.getLayoutAfterProportionalVerticalResize(o,r):n=this.getLayoutAfterProportionalHorizontalResize(o,r),n=t.mapValues(n,Math.round)):n=this.getLayoutAfterStandardResize(o,r),n})}var c=180/Math.PI,l=1/c,p={TOP:-1,BOTTOM:1,LEFT:-1,RIGHT:1,NONE:0};return{Drag:s,Rotate:function(e,i,r){e&&(this.initLayout=e,this.initMouseLocation=i,this.center=o(r),this.initMouseAngle=n(this.initMouseLocation,this.center),this.getLayout=function(e){var i=t.clone(this.initLayout),o=n(e,this.center);return i.rotationInDegrees+=(o-this.initMouseAngle)*c,i})},Resize:u,dragLayout:r,resizeLayout:function(t,e,n,i,o){return t?new u(t,e,n,i).getLayout(o):null}}}),define("core/utils/compsSectionsAnalyzer",["lodash"],function(t){"use strict";function e(e,n){return t(n).reject(function(t){return e.components.layout.isPinned(t)}).map(function(t){var n=e.components.layout.get(t);return n.bounding&&(n=n.bounding),n.bottomY=n.y+n.height,{layout:n,comp:t}}).sortBy("layout.y").value()}function n(e,n){return t.filter(e,function(t){return function(t,e){var n=e?g:d;return t.layout.width>=n}(t,n)})}function i(e,n,i){return t.forEach(e,function(e){var o=function(t){return{y:t.position.top,bottomY:t.position.bottom,height:r(t)}}(e),s=t.filter(n,function(t){return function(t,e,n){n=n||1;var i=e.y>=t.y&&e.y<=t.bottomY,o=e.bottomY>=t.y&&e.bottomY<=t.bottomY,r=e.y<=t.y&&e.bottomY>=t.bottomY;return i&&t.bottomY-e.y>=e.height*n||o&&e.bottomY-t.y>=e.height*n||r&&t.height>=e.height*n}(o,t.layout,i)});n=t.difference(n,s),e.comps=t.union(e.comps,t.map(s,"comp"))}),e}function o(t,e){for(var n=[],i=0;i<t.length;i++){var o=t[i],r={position:{top:o.layout.y,bottom:o.layout.bottomY},comps:[]};r.position.top=o.layout.y,r.comps.push(o.comp);for(var s=!1;!s;){var a=t[i+1];!a||a.layout.y>r.position.bottom+e?s=!0:(r.comps.push(a.comp),r.position.bottom=Math.max(r.position.bottom,a.layout.bottomY),i++)}n.push(r)}return n}function r(t){return t.position.bottom-t.position.top}function s(t,e,n){var i=t[e],o=t[n];o.comps=o.comps.concat(i.comps),o.position.top=Math.min(o.position.top,i.position.top),o.position.bottom=Math.max(o.position.bottom,i.position.bottom),t.splice(e,1)}function a(t){for(var e,n,i,o,a=0;a<t.length;a++)if(o=!1,e=t[a],r(e)<m){i=t[a-1],n=t[a+1];var u=i?e.position.top-i.position.bottom:Number.POSITIVE_INFINITY,c=n?n.position.top-e.position.bottom:Number.POSITIVE_INFINITY;u<c&&u<=h?(s(t,a,a-1),o=!0):c<u&&c<=h&&(s(t,a,a+1),o=!0),o&&a--}return t}function u(t){for(var e=0;e<t.length;){t[e+1]&&t[e+1].position.top<=t[e].position.bottom+f?s(t,e+1,e):e++}return t}function c(t){return t.position.bottom<0}function l(e,n){return t.map(n,function(n){var i=t.some(n.comps,function(t){return!e.components.is.removable(t)});return n.isRemovable=!i,n})}function p(r,s){var p=e(r,r.components.getChildren(s)),d=n(p,r.isMobileEditor()),g=t.difference(p,d),m=o(d,f),h=o(g=function(e,n){var i=t(n).flatMap("comps").keyBy("id").value();return t.reject(e,function(t){return!!i[t.comp.id]})}(g,m=i(m,g,.5)),y);return t(m).union(h).sortBy("position.top").thru(a).thru(u).reject(c).thru(t.partial(l,r)).value()}var d=700,g=300,m=30,h=30,f=-3,y=30;return{analyzeContainer:p,getSortedComponentsWithLayout:e}}),define("core/utils/sectionsReorganizeUtil",["lodash","core/utils/compsSectionsAnalyzer"],function(t,e){"use strict";function n(t){return t.position.top}function i(t){return t.position.bottom-t.position.top}function o(e,n,i){t.forEach(n,function(t){var n=e.components.layout.get(t);e.components.layout.update(t,{y:n.y+i},!0)})}function r(e,n){var o=t.clone(e.position),r=t.clone(n.position),s=i(e),a=i(n),u=s-a;e.position.top=r.top-u,e.position.bottom=e.position.top+s,n.position.top=o.top,n.position.bottom=n.position.top+a}function s(e,n,i){var o=t.findIndex(e,n),r=t.findIndex(e,i);e[o]=i,e[r]=n}function a(t,e,n){e.position.top+=n,e.position.bottom+=n,e.comps&&o(t,e.comps,n)}function u(n,i){i=i||n.pages.getFocusedPage();var o=e.analyzeContainer(n,i),r=n.components.layout.getRelativeToScreen(i);return t.forEach(o,function(t){t.position.top+=r.y,t.position.bottom+=r.y}),n.isMobileEditor()?(o=t.union(function(n,i){var o=n.documentServices.siteSegments.getSiteStructure(i),r=n.documentServices.components.get.byType("wysiwyg.viewer.components.SiteRegionContainer",o)||[];if(!r.length)return[];var s=e.getSortedComponentsWithLayout(n,r);return t.map(s,function(t){return{position:{top:t.layout.y,bottom:t.layout.bottomY},comps:[t.comp],isStaticSection:!0}})}(n,"MOBILE"),o),t.sortBy(o,"position.top")):o}return{addSectionByPosition:function(e,n){var i=t.findIndex(e,function(t){return t.position.top>n.position.top});return i?e.splice(i,0,n):e.push(n),e},getSectionSizeForBI:function(t){return t>500?"large":t>61?"medium":"small"},getPageSections:u,getHeaderSection:function(t){var e=t.components.layout.getRelativeToScreen(t.documentServices.siteSegments.getHeader());return{position:{top:e.y,bottom:e.height}}},duplicateSection:function(t,e,n){for(var o=e[n],r=t.components.layout.getRelativeToStructure(o.comps),s=i(o),u=n+1;u<e.length;u++)a(t,e[u],s);var c=t.copyPaste.duplicate(o.comps);t.documentServices.waitForChangesApplied(function(){t.components.layout.updateRelativeToStructure(c,{x:r.x,y:o.position.bottom})})},deleteSection:function(t,e,n){for(var o=e[n],r=i(o),s=n+1;s<e.length;s++)a(t,e[s],-1*r);t.components.remove(o.comps)},shiftSection:a,switchSectionsByDrag:function(t,e,i,a){var u,c;i.position.top<a.position.top?(u=i,c=a):(u=a,c=i);var l=n(u),p=n(c);r(u,c),s(e,u,c),a===c?o(t,a.comps,n(c)-p):o(t,a.comps,n(u)-l)},switchSections:function(t,e,i,a){var u=n(i),c=n(a);r(i,a),s(e,i,a),o(t,a.comps,n(a)-c),o(t,i.comps,n(i)-u)},isAtSectionsSwitchPoint:function(t,e,n){var o=i(e),r=e.position.top+o/2;return 1===n?t.y+t.height>=r:t.y<=r}}}),define("core/utils/mouseMoveActions/sectionDrag",["lodash","core/utils/layoutTransitionsUtil","core/utils/sectionsReorganizeUtil","constants"],function(t,e,n,i){"use strict";function o(t,e){return t.clientY+g.ui.scroll.getScroll().scrollTop/(e||1)}function r(t){var e={x:0,y:t},n=P.getLayout(e);return n.y=Math.max(n.y,T),n}function s(e){for(var n=P.getBoundComponentLayouts(e),i=0;i<h.comps.length;i++)g.components.layout.updateRelativeToScreen(h.comps[i],t.pick(n[i],"y"),!0)}function a(e,i){var o=function(t){return t>f?1:-1}(e);f=e;var r=t.findIndex(m,h)+o;if(r>=m.length||r<0)return!1;var s=m[r];return!(!s||!n.isAtSectionsSwitchPoint(i,s,o))&&(n.switchSectionsByDrag(g,m,h,s),t.defer(c),!0)}function u(t,e){return e.position.top<t.position.bottom}function c(){var e=t.findIndex(m,h),i=m[e-1],o=m[e+1],r=0,s=0;if(o&&u(h,o)&&(s=h.position.bottom-o.position.top),i&&u(i,h)&&(s+=r=i.position.bottom-h.position.top),r&&n.shiftSection(g,h,r),s)for(var a=e+1;a<m.length;a++)n.shiftSection(g,m[a],s)}function l(n,i){if(C=!1,y=!0,g=n,h=i.draggedSection){var r={x:0,y:o(i.evt,g.getSiteScale())};f=r.y,m=t.sortBy(i.sections,"position.top"),v=i.onDragEnd,S=i.onDragStart,T=i.minY||0;var s={y:h.position.top,height:h.position.bottom-h.position.top},a=t.map(h.comps,function(t){return g.components.layout.getRelativeToScreen(t)});P=new e.Drag(s,r,a)}}function p(e){if(h)if(y)y=!1,function(){var e=t.map(h.comps,"id");t.isEmpty(e)||(g.documentServices.renderPlugins.setCompsToShowOnTop(e),g.documentServices.renderPlugins.setCompsToShowWithOpacity(e,.5)),t.isFunction(S)&&S(),window.setTimeout(function(){c(),C=!0},I)}();else if(C){var n=o(e,g.getSiteScale()),i=r(n);s(i),a(n,i)}}function d(e){var n=o(e);h&&!y&&(!function(t){var e=r({y:t,x:0});e.y=h.position.top,s(e)}(n),g.history.add("Dragged Components Section"),g.documentServices.renderPlugins.setCompsToShowOnTop(null),g.documentServices.renderPlugins.setCompsToShowWithOpacity(null)),t.isFunction(v)&&v(h)}var g,m,h,f,y,P,v,S,C,T,I=0;return{start:l,on:p,end:d,type:i.MOUSE_ACTION_TYPES.SECTION_DRAG}}),define("core/utils/AddPanelSectionDragHandler",["lodash","core/utils/AddPanelDragHandler","core/utils/mouseMoveActions/sectionDrag","core/utils/sectionsReorganizeUtil"],function(t,e,n,i){"use strict";function o(t,n,i,o,r,s,a){e.call(this,t,n,i,o,r,s,a)}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,t.assign(o.prototype,{init:t.noop,getFixedDragPosition:function(t){return{x:t.clientX,y:t.clientY}},handleDragOutsidePanelArea:function(t){var e=this.getDragBoxStageLayout();this.handleSectionDrag(t,e)},handleDragInPanelArea:function(){this.cancelSectionDragIfNeeded()},handleSectionDrag:function(t,e){this.isSectionDrag||(this.initSectionDrag(t,e),this.isSectionDrag=!0),this.draggedSection.layout.y=e.y,n.on(t)},initSectionDrag:function(e,o){this.draggedSection=function(e,n){var i=function(t){var e=t.pages.getFocusedPage();return t.components.layout.getRelativeToScreen(e)}(e),o=Math.max(i.y-n.y,0);return{origin:"addPanel",comps:[],layout:t.pick(n,["y","height"]),position:{top:n.y+o,bottom:n.y+n.height+o}}}(this.editorAPI,o);var r=i.getPageSections(this.editorAPI);r=i.addSectionByPosition(r,this.draggedSection),this.editorAPI.setPageSections(r,null),n.start(this.editorAPI,{sections:r,evt:e,draggedSection:this.draggedSection})},cancelSectionDragIfNeeded:function(){this.isSectionDrag&&(this.isSectionDrag=!1,this.editorAPI.history.add("sections reorganize"),this.editorAPI.history.undo(),this.editorAPI.clearPageSections())},clearDrag:function(){this.isSectionDrag&&this.editorAPI.clearPageSections()},getDropContainer:function(){return this.editorAPI.pages.getFocusedPage()},getCompPositionRelativeToContainer:function(t,n){var i=e.prototype.getCompPositionRelativeToContainer.call(this,t,n),o=this.draggedSection.position.top-this.draggedSection.layout.y;return i.y+=o,i}}),o}),define("core/utils/AttachHandlerExperimentAttachImprovements",["lodash"],function(t){"use strict";function e(e,n,i){var s=e.documentServices.siteSegments.getHeader(),a=e.documentServices.siteSegments.getFooter(),u=e.documentServices.pages.getFocusedPageId(),c=e.components.getAllComponents(u);(function(t){return t.isMobileEditor()})(e,n.comp)&&(c=c.concat(e.documentServices.siteSegments.getSiteStructure()));return i===o.COMP&&!e.components.isShowOnAllPages(n.comp)&&(c=function(e,n){var i=e.documentServices.siteSegments.getFooter();return t.filter(n,function(t){var n=e.components.isDescendantOfComp(t,i);return!e.utils.isSameRef(t,i)&&!n})}(e,c)),t(c).filter(function(t){return!e.components.layout.isRenderedInFixedPosition(t)&&!e.utils.isSameRef(t,n.comp)&&r[i].isContainable(e,n.comp,t)}).map(function(t){return{layout:function(t,e){return t.components.layout.getRelativeToScreen(e)}(e,t),comp:t}}).filter(function(t){return e.components.is.container(t.comp)}).filter(function(t){return e.components.isRenderedOnSite(t.comp)}).filter(function(t){var i=e.utils.isSameRef(t.comp,s),o=e.utils.isSameRef(t.comp,a);return t.layout.width>=n.layout.width&&t.layout.height>=n.layout.height||i||o}).value()}function n(e,n){var i=this.editorAPI.documentServices.siteSegments.getHeader(),o=this.editorAPI.documentServices.siteSegments.getFooter(),r=t.find(this.attachCandidates,t.bind(function(r){var s=this.editorAPI.utils.isSameRef(r.comp,i),a=this.editorAPI.utils.isSameRef(r.comp,o);return this.editorAPI.components.is.page(r.comp)||s||a||function(t){return this.currentAttachedContainer&&this.currentAttachedContainer.id===t.id}.call(this,r.comp)?function(e,n,i){var o=e.selection.getComponentsUnderClick(n);return t.some(o,function(t){return e.utils.isSameRef(t,i)})}(this.editorAPI,n,r.comp):function(t,e,n,i){var o=t.components.is.fullWidth(e),r=t.utils.isSameRef(e,t.documentServices.siteSegments.getHeader());return(o||n.x>=i.x)&&(o||n.x+n.width<=i.x+i.width)&&(r||n.y>=i.y)&&n.y+n.height<=i.y+i.height}(this.editorAPI,r.comp,e,r.layout)},this));return r?(this.currentAttachedContainer=r.comp,r.comp):null}function i(t,n,i){t&&(this.editorAPI=t,this.type=i,this.comp=n.comp,this.currentAttachedContainer=null,this.attachCandidates=e(t,n,i))}var o={COMP:"comp",STRUCTURE:"structure"},r={comp:{getContainer:function(t,e){return t.components.getContainer(e)},isContainable:function(t,e,n){return t.components.is.containable(e,n)&&!t.components.is.group(n)},getCompLayout:function(t,e){return t.components.layout.getRelativeToScreen(e).bounding},getCompType:function(t,e){return t.components.getType(e)},isShowOnAllPages:function(t,e){return t.components.isShowOnAllPages(e)}},structure:{getCompType:function(){return""},getContainer:function(){return{}},isContainable:function(t,e,n){return t.components.is.containableByStructure(e,n)&&!t.components.is.group(n)},isShowOnAllPages:function(){return!1}}};return i.prototype.getCurrentAttachCandidate=function(t,e){var i=t||r[this.type].getCompLayout(this.editorAPI,this.comp);return n.call(this,i,e)||null},i.prototype.highlightAttachCandidate=function(t){t&&this.editorAPI.utils.isSiteStructure(t)||this.editorAPI.setAttachCandidate(t,this.type===o.STRUCTURE)},i.TYPES=o,i}),define("core/utils/updateDataUtil",["lodash","core/utils/updateDataPlugins/updateDataPlugins"],function(t,e){"use strict";function n(i){return e[i.type]&&e[i.type](i),t.forEach(i,function(e){t.isPlainObject(e)&&e.type&&n(e)}),i}return{fixData:n}}),define("core/utils/updatePropertiesPlugins/plugins/wPhotoPropertiesPlugin",["lodash"],function(t){"use strict";return function(e,n,i,o){return o||function(e,n,i){var o=t.pick(e,"effectName");if(!t.isEmpty(o)){var r=i.viewMode.VIEW_MODES.MOBILE,s=i.components.getPage(n).id,a=i.components.get.byId(n.id,s,r);a&&i.components.is.exist(a)&&i.components.properties.mobile.isForked(a)&&i.components.properties.update(a,o)}}(e,n,i),e}}),define("core/utils/updatePropertiesPlugins/updatePropertiesPlugins",["core/utils/updatePropertiesPlugins/plugins/wPhotoPropertiesPlugin"],function(t){"use strict";return{WPhotoProperties:t}}),define("core/utils/updatePropertiesUtil",["lodash","core/utils/updatePropertiesPlugins/updatePropertiesPlugins"],function(t,e){"use strict";return{fixProperties:function(t,n,i,o){var r=t.type||"DefaultProperties";return e[r]&&e[r](t,n,i,o),t}}}),define("core/utils/DragConstraintsHandler",["lodash","core/utils/layoutConstraintsUtil/EditorLayoutConstraintsUtil"],function(t,e){"use strict";function n(t,n){if(t){this.editorAPI=t,this.comp=n;var i=new e(t,n);this.constraintArea=i.getConstraintArea(t,n)}}return n.prototype.highlightDragConstraints=function(){this.editorAPI.setConstraintArea(this.constraintArea)},n.prototype.removeHighlightDragConstraints=function(){this.editorAPI.setConstraintArea(null)},n}),define("core/utils/compControlsMeasurer",["lodash","jquery","uiConstants","experiment"],function(t,e,n,i){"use strict";function o(t){return{y:t.y,x:t.x,width:t.width,height:t.height,bottomY:t.y+t.height,rightX:t.x+t.width}}function r(t,e){var n=e.viewPortForChildOfFocused||e.viewPort;return t.y>=n.y?v.COMP_TOP:t.bottomY<=n.bottomY?v.COMP_BOTTOM:v.VIEWPORT_TOP}function s(t,n,i){var o=n.viewPort,r=o.bottomY-t.y,s=t.bottomY-o.y,a=i?e(i).height():0,u=t.y<o.y,c=a<=r,l=t.bottomY>o.bottomY,p=a<=s,d=a<=o.bottomY-o.y;return u||!d?v.VIEWPORT_TOP:c?v.COMP_TOP:l?v.VIEWPORT_BOTTOM:p?v.COMP_BOTTOM:v.VIEWPORT_TOP}function a(t,e,n){return{gfpp:r(t,e),compPanel:s(t,e,n)}}function u(t,e,n,i,o){var r=Math.max(y,o&&o.top||0)+i,s=i+y,a=Math.max(y,o&&o.bottom||0);switch(t){case v.COMP_TOP:return Math.max(e.y-r,n.y-s);case v.COMP_BOTTOM:return e.bottomY+a;case v.VIEWPORT_TOP:return n.y-s}}function c(t,e,n,i){switch(t){case v.COMP_BOTTOM:return e.bottomY-i;case v.COMP_TOP:return e.y;case v.VIEWPORT_BOTTOM:return n.bottomY-i}return n.y}function l(t,e,n,i,o){if(f(e,n.width)){return Math.max(o,n.x)}switch(t){case v.COMP_LEFT:return e.x;case v.VIEWPORT_LEFT:return n.x;case v.VIEWPORT_RIGHT:return n.rightX-i}}function p(t,n,i,o,r){var a=r.gfppSize,p=r.viewPort,d=r.rotateKnobMargins,g=r.pageXBoundary,m=r.alignToPageBoundaries,h={gfpp:{top:0,left:0},compPanel:{top:0,left:0}},S=a.height,C=a.width,T=o?e(o).height():0,I=o?e(o).width():0;if(h.gfpp.top=u(t.gfpp,i,p,S,d),h.gfpp.left=l(n.gfpp,i,p,C,g),m||f(i,p.width)){var x=Math.max(g,p.x),A=function(t,n,i,o,r,a,u){var l={left:0,top:0},p=i?e(i).height():0,d=i?e(i).width():0;if(0===d||0===p)return{left:0,top:0};var g=c(s(t,{viewPort:n},i),t,n,p),m=d<=r-n.x,h=p<=n.bottomY-u,f=a===v.COMP_TOP&&p<=u-n.y-P,S=a===v.COMP_BOTTOM&&p<=n.bottomY-(u+o)-P;m?(l.left=r-(d+P/2),l.top=h?u:n.bottomY-p):f?(l.left=r,l.top=u-(p+y)):S?(l.left=r,l.top=u+o+y):(l.left=n.rightX-d,l.top=g);return l}(i,p,o,a.height,x,t.gfpp,h.gfpp.top);h.compPanel=A}else h.compPanel.top=c(t.compPanel,i,p,T),h.compPanel.left=function(t,e,n,i,o,r,s){var a=e.rightX-e.x;switch(t){case v.COMP_LEFT:return e.x-i-Math.max(P,s&&s.left||0);case v.COMP_RIGHT:return e.x+a+Math.max(P,s&&s.right||0);case v.VIEWPORT_LEFT:return n.x;case v.VIEWPORT_RIGHT:return n.rightX-i-P;case v.GFPP_LEFT:return r-i-P;case v.GFPP_RIGHT:return r+o+P}}(n.compPanel,i,p,I,C,h.gfpp.left,d);return h}function d(t,e,n){return t.x>=e.x?n+t.x<=e.rightX?v.COMP_LEFT:v.VIEWPORT_RIGHT:v.VIEWPORT_LEFT}function g(t,e,i){var o={},r=function(t){var e=t.x+n.CUSTOM_GFPP_POS.X_OFFSET_FROM_CLICK,i=t.y;return{y:i,x:e,width:0,height:0,bottomY:i,rightX:e}}(t),s=a(r,{viewPort:e}).gfpp,c=d(r,e,i.width);return o.top=u(s,r,e,i.height),o.left=l(c,r,e,i.width,0),o}function m(t,i,o,r){var s,a,u=r.gfppSize,c=r.viewPort,l=r.navControlsSize,p=u.width,g=o?e(o).width():0,m=t.rightX-t.x,h={};return h.gfpp=d(t,c,p),h.navControls=function(t,e,i){return t.x>=e.x?i+t.x+n.NAVIGATION_CONTROLS_POS.LEFT<=e.rightX?v.COMP_LEFT:v.VIEWPORT_RIGHT:v.VIEWPORT_LEFT}(t,c,l.width),i.gfpp===i.compPanel?(s=t.rightX+g+P<=c.rightX,a=t.x-g-P>=c.x,t.rightX<c.x?h.compPanel=v.VIEWPORT_LEFT:h.compPanel=s?v.COMP_RIGHT:a?v.COMP_LEFT:v.VIEWPORT_RIGHT):h.gfpp===v.COMP_LEFT?p<=m?(s=t.x+m+P+g<c.rightX,a=t.x-P-g>=c.x,h.compPanel=s?v.COMP_RIGHT:a?v.COMP_LEFT:v.VIEWPORT_RIGHT):(a=t.x-P-g>=c.x,h.compPanel=a?v.COMP_LEFT:v.GFPP_RIGHT):h.gfpp===v.VIEWPORT_RIGHT?h.compPanel=v.GFPP_LEFT:h.gfpp===v.VIEWPORT_LEFT&&((s=Math.max(c.x+p,t.x+m)+g<=c.rightX)?c.x+p>t.x+m?h.compPanel=v.GFPP_RIGHT:h.compPanel=v.COMP_RIGHT:h.compPanel=v.VIEWPORT_RIGHT),h}function h(t,e,i){var o=a(t,i,e),r=m(t,o,e,i),s=p(o,r,t,e,i),u=function(t,e,i,o){var r=o.navControlsSize,s=o.viewPort,a=o.pageXBoundary,u={};if(f(i,s.width)){var c=Math.max(a,s.x);u.left=c-i.x+n.NAVIGATION_CONTROLS_POS.LEFT}else switch(e.navControls){case v.VIEWPORT_LEFT:u.left=s.x-i.x+n.NAVIGATION_CONTROLS_POS.LEFT;break;case v.VIEWPORT_RIGHT:u.left=s.rightX-(i.x+r.width+n.NAVIGATION_CONTROLS_POS.LEFT);break;case v.COMP_LEFT:u.left=n.NAVIGATION_CONTROLS_POS.LEFT}switch(t.gfpp){case v.COMP_BOTTOM:u.top=n.NAVIGATION_CONTROLS_POS.BOTTOM;break;case v.COMP_TOP:case v.VIEWPORT_TOP:u.top=n.NAVIGATION_CONTROLS_POS.TOP}return u}(o,r,t,i),c=function(t,e){return e.navControlsSize.width?t.left+e.navControlsSize.width+n.MARGIN_BETWEEN_FOCUS_TAB_AND_COMP_LABELS:0}(u,i);return{gfppStyle:s.gfpp,compPanelStyle:s.compPanel,navControlsStyle:u,editBoxLabelsOffset:c}}function f(t,e){return t.x<1&&t.width>=e}var y,P=n.compPanelMargins,v={COMP_TOP:"compTop",COMP_BOTTOM:"compBottom",COMP_LEFT:"compLeft",COMP_RIGHT:"compRight",VIEWPORT_TOP:"viewPortTop",VIEWPORT_BOTTOM:"viewPortBottom",VIEWPORT_LEFT:"viewPortLeft",VIEWPORT_RIGHT:"viewPortRight",GFPP_LEFT:"gfppLeft",GFPP_RIGHT:"gfppRight"};return{getCompControlsPositions:function(e,r,s,a,u){a=t(a).pickBy(t.identity).defaults({gfppSize:{width:0,height:0},navControlsSize:{width:0,height:0},pageXBoundary:0,rotateKnobMargins:{},alignToPageBoundaries:!1}).value();var c,l,p=o(s.layout),d=e&&e.id!==s.id;if(i.isOpen("se_platform1")?(y=n.gfppMargins,e&&!d?y=n.navControlsGfppMargins:s.hasLabels&&(y=n.componentLabelsGfppMargins)):y=e&&!d?n.navControlsGfppMargins:n.gfppMargins,c=e?h(l=o(e.layout),r,a):h(p,r,a),e&&d){var m=function(e,i,o){if(i.height<o.height+2*n.VIEWPORT_VERTICAL_MARGINS)return e;var r={y:Math.max(e.y,i.y+n.VIEWPORT_VERTICAL_MARGINS),height:Math.min(e.height,i.height-2*n.VIEWPORT_VERTICAL_MARGINS),bottomY:Math.min(e.bottomY,i.bottomY-n.VIEWPORT_VERTICAL_MARGINS)};return t.assign({},e,r)}(a.viewPort,l,p),f=h(p,r,t.defaults({viewPortForChildOfFocused:m},a));c.gfppStyle=f.gfppStyle,c.compPanelStyle=f.compPanelStyle,c.editBoxLabelsOffset=0}return u&&(c.gfppStyle=g(u,a.viewPort,a.gfppSize)),c},getGfppPosition:function(t,e,i){y=n.gfppMargins;var s=o(e),a=r(s,{viewPort:i}),c=d(s,i,t.width);return{top:u(a,s,i,t.height),left:l(c,s,i,t.width,0)}}}}),define("core/utils/fixedPositionPlugins/tinyMenuFixedPositionPlugin",["lodash","core/app/constants"],function(t,e){"use strict";function n(n,i,o){var r=n.components.layout.getRelativeToStructure(i),s={fixedPosition:o},a=e.SIZE_LIMITS.FIXED_TINY_MENU_MAX_Y;r.y>a&&(!function(e,n){var i=e.components.getContainer(n),o=e.documentServices.siteSegments.getHeader();t.isEqual(i,o)||e.components.setContainer(n,o)}(n,i),t.merge(s,n.mobile.mobileOnlyComponents.getTinyMenuDefaultPosition())),n.components.layout.update(i,s)}return n}),define("core/utils/fixedPositionPlugins/fixedPositionPlugins",["lodash","core/utils/fixedPositionPlugins/tinyMenuFixedPositionPlugin"],function(t,e){"use strict";var n={"wysiwyg.viewer.components.mobile.TinyMenu":e};return{registerPlugin:function(t,e){n[t]=e},setFixedPosition:function(e,i,o){var r=e.components.getType(i);return n[r]&&t.isFunction(n[r])?n[r].call(null,e,i,o):function(t,e,n){t.components.layout.updateFixedPosition(e[0],n)}(e,i,o),o}}}),define("core/utils/social",["lodash","util","require","coreUtilsLib"],function(t,e,n,i){"use strict";function o(t){window.open(t)}var r="https://twitter.com/intent/tweet?url=",s="135c3d92-0fea-1f9d-2ba5-2a1dfb04297e",a="feedb3b8-0b1a-413f-bcab-73e805d0f554",u=t.once(function(e){var n,i=function(){var t=window.location.hostname.match(/editor\.(.*)/);return t?"www."+t[1]:"www.wix.com"}(),o={appId:n=t.includes(i,"wix.com")?"304553036307597":"394905507233800",status:!0,cookie:!0,xfbml:1};e.init(o)});return{openShoutout:function(t){o(["http://www.wix.com/my-account/sites/",t,"/app/",s,"?referralInfo=ed_prem_promo","&appState=%3Fdl%3Dmessage%26messageId%3D",a].join(""))},openTwitter:function(t,n){o(function(e,n,i){return e=decodeURIComponent(e),r+t+"&text="+e+"&related="+n+"&hashtags="+i}(n?e.translate("TWITTER_CHECK_OUT_MY_SITE_MSG_PREMIUM"):e.translate("TWITTER_CHECK_OUT_MY_SITE_MSG_NON_PREMIUM"),e.translate("TWITTER_RELATED_WIX_ACCOUNTS"),e.translate("TWITTER_WIX_HASHTAGS")))},openFacebook:function(o,r,s,a){n(["facebook"],function(n){u(n);var i=function(t){return"http://"+r+".wix.com/html5webbuilder/share?utm_campaign=vir_fb_pub_h_"+r+"&experiment_id="+t.replace(/https?:\/\//,"")}(t.clone(o)),c={method:"feed",name:s,description:a,link:o,actions:[{name:e.translate("FACEBBOK_SHARE_MESSAGE"),link:i}]};n.ui(c)},function(t){i.log.error(t)})}}}),define("core/utils/spotifyUtils",["util"],function(t){"use strict";var e=["tracks","albums","artists"],n=t.url.joinURL(t.editorModel.editorBase,"app/external/SpotifySearch/index.html?id=");return{openIframe:function(t,i,o){var r=t.getLanguageCode(),s="spotifySearch_"+Date.now();i=i||e;var a=t.selection.getSelectedComponentType();t.panelManager.openPanel("panels.focusPanels.spotifySearchFocusPanel",{panelName:"Spotify Search",iframeSrc:function(t,e,i){return n+t+"&lang="+i+"&tabs="+JSON.stringify(e)+"&default_tab="+e[0]+"&fontFaceUrl=https://static.parastorage.com/services/wix-public/1.160.0/css/Helvetica/fontFace.css"}(s,i,r),id:s,selectedComponentType:a,callback:o},!1)},validateSpotifyUri:function(t){return function(t){return t&&0===t.indexOf("spotify:")}(t)&&function(t){var e=t.split(":");return e.length>2&&e[e.length-1].length>0}(t)},validateFollowUri:function(t){return 0===t.toLowerCase().indexOf("spotify:artist:")}}}),define("core/utils/uiControlsBIUtil",["lodash","coreBi"],function(t,e){"use strict";var n=e.CONTROLS_TO_EVENTS;return{getEventDefinition:function(t){return n[t]},getParams:function(e,i){var o=t(n[e].fields).keys().union(["value"]).value();return t(i).pick(o).mapValues(function(t){return"boolean"==typeof t?t.toString():t}).value()}}}),define("core/app/styleManager",["lodash"],function(t){"use strict";function e(e,n){return t.isEqual(e,n)}function n(e){var n=e.styles.getAllIds();return t.map(n,e.styles.get)}function i(e,i,o){var r=n(e);return t.filter(r,function(e){return(e.componentClassName===i||o&&o.length>0&&t.includes(o,e.componentClassName))&&"custom"===e.styleType})}function o(e,n){var i=function(e,n){var i=t.find(e,function(t){return t.styles[n]});return i&&i.styles[n]}(e,n);return i?{id:n,compId:"",componentClassName:"",pageId:"",styleType:"system",type:"TopLevelStyle",skin:i,style:{groups:{},properties:{},propertiesSource:{}}}:null}function r(e){var n=t.map(e,function(t,e){return[e,t]});return t.sortBy(n,t.head)}return{getStyleIdByDef:function(i,o,r,s){if("system"===r.styleType)return r.id;var a=function(e,i){var o=n(e);return t.filter(o,{skin:i})}(i,r.skin),u=t.find(a,function(n){if(t.isUndefined(n.style)&&r.style)return!1;if(n.style&&r.style){var i=o.COMPONENT_DEFINITION_MAP[s]?t.keys(o.COMPONENT_DEFINITION_MAP[s].styles):[];return!(!t.includes(i,n.id)&&n.componentClassName!==s)&&e(n.style.properties,r.style.properties)}return!0});return u?u.id:this.createNewStyleByDef(i,r,r.componentClassName)},createNewStyleByDef:function(e,n,i){var o=t.cloneDeep(n);return o.styleType="custom",o.componentClassName=o.componentClassName||i,e.styles.createAndAddItem(o).id},getStyleById:function(t,e,n){var i=t.styles.get(n);return i||(i=o(e.COMPONENT_DEFINITION_MAP,n)),i},getUniqueCustomStyleList:function(e,n,o){var s=i(e,o),a=this.getUniqueThemeStyleList(e,n,o),u=t.uniqBy(s,function(t){return JSON.stringify(t.style?r(t.style.properties):{})});return t.remove(u,t.bind(function(e){return t.find(a,t.bind(function(t){return this.isEqualWithoutTypeConsideration(e,t)},this))},this)),t.sortBy(u,"skin")},getUniqueThemeStyleList:function(e,n,i){var o=this.getThemedStyleForComp(e,n,i),s=t.uniqBy(o,function(t){return JSON.stringify(t.style?r(t.style.properties):{})+t.skin});return t.sortBy(s,"skin")},getThemedStyleForComp:function(e,n,i){var o=n.COMPONENT_DEFINITION_MAP[i]?t.keys(n.COMPONENT_DEFINITION_MAP[i].styles):[];return t.map(o,t.bind(function(t){return this.getStyleById(e,n,t)},this))},getDuplicateToStyleList:function(e,n,o,r,s){var a=this.getThemedStyleForComp(e,n,r),u=i(e,r,s),c=a.concat(u);return t(c).reject({id:o.id}).filter(this.isEqualWithoutTypeConsideration.bind(this,o)).value()},getUniqueStyleList:function(t,e,n){var i=this.getUniqueCustomStyleList(t,e,n);return this.getUniqueThemeStyleList(t,e,n).concat(i)},isEqual:function(t,n){if(!t||!n)throw new Error("Style is not defined");return t.skin===n.skin&&t.styleType===n.styleType&&("system"===t.styleType?t.id===n.id:!t.style||!n.style||e(t.style.properties,n.style.properties))},isEqualWithoutTypeConsideration:function(t,n){if(!t||!n)throw new Error("Style is not defined");return t.skin===n.skin&&(!t.style||!n.style||e(t.style.properties,n.style.properties))},getTempStyleId:function(t,e){var n=this.createNewStyleByDef(t,e);return t.styles.setExcluded(n),n},prepareTempStyleValue:function(t){t.styleType="custom"}}}),define("core/utils/defaultActions/mediaManagerDefaultActions",["lodash","util","constants","core/app/styleManager","core/utils/mediaManagerPresetUtil","core/utils/updateLayoutUtil"],function(t,e,n,i,o,r){"use strict";function s(e,n,i){var s=e.components.data.get(n),a=e.components.design.get(n),u=t.get(s,["svgId"]),m="shape"===i?l:c,h=o.getPath(e,u)||m,f=e.media.vectorImage.getSvgInfoFromCache(u);e.mediaServices.mediaManager.open(e.mediaServices.mediaManager.categories[p],{multiSelect:!1,callback:function(i,u){if(!t.isEmpty(i)){var c=t.get(i,[0,"title"],""),l=t.get(i,[0,"uri"]);e.media.vectorImage.fetchSvg(l,t.noop),e.documentServices.waitForChangesApplied(function(){var i=t.assign({},s,{svgId:l,title:c}),o=t.get(e.media.vectorImage.getSvgInfoFromCache(l),"svgType"),u=t.assign({},a,function(e,n,i){var o,r=t.assign(t.omit(n,"svgType"),t.get(e,"overrideColors")),s=t.get(e,["shapeStyle"]),a=t.get(s,["opacity"],d.opacity),u=r.color1&&!r.color2?r.color1:g.color1;switch(i){case"shape":o={overrideColors:{color1:u},shapeStyle:t.defaults(s,d)};break;case"tint":o={overrideColors:{color1:u},shapeStyle:{opacity:a}};break;case"color":o={overrideColors:null,shapeStyle:{opacity:a}}}return o}(a,f,o));e.components.data.update(n,i,!0),e.components.design.update(n,u,!0),e.documentServices.waitForChangesApplied(function(){!function(t,e){var n=t.components.properties.get(e);if("fit"===n.displayMode||"legacyFit"===n.displayMode){var i=t.media.vectorImage.getSvgOriginalAspectRatio(e);r.resetCompLayoutToAspectRatio(t,e,i),t.components.properties.update(e,{displayMode:"fit"},!0)}}(e,n),e.history.add("Change Vector Image")})}),o.storePath(e,l,u.path)}},path:h})}var a=["uri","width","height","title","originalImageDataRef","type"],u=["uri","width","height","title"],c="public/3980fbc8-b1b0-4ebd-9bda-2c0578ca9462/d9b8c13b-6067-4103-bdb7-cbe035b07711",l="public/ec9ed40a-6502-4df2-a088-355405d7bd25/6a7c5cab-2dfb-4447-bdea-93157abf1300",p="VECTOR_ART",d=n.VECTOR_IMAGE_DEFAULTS.VECTOR_SHAPE_DEFAULT_STYLE,g=n.VECTOR_IMAGE_DEFAULTS.VECTOR_SHAPE_COLOR_DEFAULT;return{changeBgImageStrip:function(e,n){e.mediaServices.mediaManager.open(e.mediaServices.mediaManager.categories.IMAGE,{multiSelect:!1,callback:function(i){if(i){var o=t.pick(i[0],a);o.uri=i[0].fileName,o.originalImageDataRef=null,o.type="Image",o.crop=null,e.components.data.update(n,o,!0),e.history.add("Change Image")}}})},changeClipArt:function(n,i,r){var s=n.components.data.get(i),a=o.getPath(n,s.uri);n.mediaServices.mediaManager.open(r,{multiSelect:!1,translation:{submitButton:e.translate("MMGR_submitbutton_onstage_clipart_freeclipart_choose")},path:a,callback:function(e,r){if(e){var s=t.pick(e[0],u);s.uri=e[0].fileName,s.originalImageDataRef=null,s.crop=null,o.storePath(n,s.uri,r.path),n.components.data.update(i,s,!0),n.history.add("Change Clipart")}}})},changeDocumentMedia:function(e,n){var i=e.mediaServices;i.mediaManager.open(i.mediaManager.categories.DOCUMENT,{multiSelect:!1,callback:function(i){if(!t.isEmpty(i)){var o=e.components.data.get(n),r=t.cloneDeep(o.link),s=i[0];r.name=s.title,r.docId=s.fileUrl,o.link=r,e.components.data.update(n,o)}}})},changeFlashComponent:function(e,n){var i=e.mediaServices;i.mediaManager.open(i.mediaManager.categories.FLASH,{multiSelect:!1,callback:function(i){if(!t.isEmpty(i)){var o=i[0],r=e.components.data.get(n);t.assign(r,{uri:o.fileName},t.pick(o,["width","height","title"])),e.components.data.update(n,r)}}})},changePinterestPinIt:function(e,n){var i=e.mediaServices;i.mediaManager.open(i.mediaManager.categories.IMAGE,{multiSelect:!1,callback:function(i){if(!t.isEmpty(i)){var o=e.components.data.get(n);o.uri=i[0].fileName,e.components.data.update(n,o)}}})},changeSingleAudioPlayer:function(e,n){var i=e.mediaServices;i.mediaManager.open(i.mediaManager.categories.MUSIC,{multiSelect:!1,callback:function(i){if(!t.isEmpty(i)){var o=i[0],r=e.components.data.get(n);t.assign(r,{uri:o.fileUrl,originalFileName:o.title,artist:"Unknown Artist",track:"Unknown Track"}),e.components.data.update(n,r)}}})},changeSvgShape:function(n,o,r){var s=n.mediaServices;s.mediaManager.open(s.mediaManager.categories.SHAPE,t.assign({multiSelect:!1,callback:function(r){if(!t.isEmpty(r)){var s=e.svgUrlParser.parseSvgSkinFromUrl(r[0].fileUrl),a=function(t,e){var n=t.components.style.getId(e);return t.theme.styles.get(n)}(n,o);if(s!==a.skin){a.skin=s;var u=i.getStyleIdByDef(n.theme,n.components,a,n.components.getType(o));n.components.style.setId(o,u),n.history.add("Change Shape")}}}},r))},changeVectorImage:function(t,e){var n=t.components.data.get(e);s(t,e,t.media.vectorImage.getSvgInfoFromCache(n.svgId).svgType)},changeWPhoto:function(e,n){e.mediaServices.mediaManager.open(e.mediaServices.mediaManager.categories.IMAGE,{multiSelect:!1,callback:function(i){if(i){var o=t.pick(i[0],a);o.uri=i[0].fileName,o.originalImageDataRef=null,o.crop=null,e.components.data.update(n,o,!0),e.history.add("Change Image")}}})}}}),define("core/utils/componentsDefaultAction",["lodash","core/bi/bi","core/app/constants","core/utils/defaultActions/mediaManagerDefaultActions","core/utils/spotifyUtils"],function(t,e,n,i,o){"use strict";function r(t,e){e&&t.openComponentPanel(e)}function s(t){return function(e){r(e,t)}}function a(t,e){t.panelHelpers.openOrganizeImagesPanel(function(n){var i=t.components.data.get(e);i.items=n,t.components.data.update(e,i)})}function u(t){t.openPagesPanel()}return{WRichText:function(t,i,o){t.isMobileEditor()?r(t,n.componentPanels.settings):(t.bi.event(e.events.textControls.Text_Panel_opened,{origin:o}),t.text.startEditing())},Container:s(n.componentPanels.design),FiveGridLine:s(n.componentPanels.design),FooterContainer:s(n.componentPanels.design),HeaderContainer:s(n.componentPanels.design),screenWidthContainer:s(n.componentPanels.design),Page:s(n.componentPanels.design),VerticalLine:s(n.componentPanels.design),Anchor:s(n.componentPanels.settings),ContactForm:s(n.componentPanels.settings),FacebookLikeBox:s(n.componentPanels.settings),FacebookShare:s(n.componentPanels.settings),FlickrBadgeWidget:s(n.componentPanels.settings),BoxSlideShow:s(n.componentPanels.settings),GoogleMap:s(n.componentPanels.settings),HtmlComponent:s(n.componentPanels.settings),ImageButton:s(n.componentPanels.settings),ItunesButton:s(n.componentPanels.settings),PayPalButton:s(n.componentPanels.settings),PinItPinWidget:s(n.componentPanels.settings),PinterestFollow:s(n.componentPanels.settings),SiteButton:s(n.componentPanels.settings),SkypeCallButton:s(n.componentPanels.settings),SoundCloudWidget:s(n.componentPanels.settings),SpotifyFollow:s(n.componentPanels.settings),SubscribeForm:s(n.componentPanels.settings),Video:s(n.componentPanels.settings),VKShareButton:s(n.componentPanels.settings),WFacebookLike:s(n.componentPanels.settings),WTwitterFollow:s(n.componentPanels.settings),WTwitterTweet:s(n.componentPanels.settings),YouTubeSubscribeButton:s(n.componentPanels.settings),AudioPlayer:function(e,n){var i=e.mediaServices;i.mediaManager.open(i.mediaManager.categories.MUSIC,{multiSelect:!1,callback:function(i){if(!t.isEmpty(i)){var o=e.components.data.get(n);o.uri=i[0].fileName,e.components.data.update(n,o)}}})},BgImageStrip:i.changeBgImageStrip,ClipArt:i.changeClipArt,DocumentMedia:i.changeDocumentMedia,FlashComponent:i.changeFlashComponent,PinterestPinIt:i.changePinterestPinIt,SingleAudioPlayer:i.changeSingleAudioPlayer,SvgShape:i.changeSvgShape,VectorImage:i.changeVectorImage,WPhoto:i.changeWPhoto,DropDownMenu:u,GalleryDefaultAction:a,MatrixGallery:a,SliderGallery:a,PaginatedGridGallery:a,Impress:a,Masonry:a,Thumbnails:a,StripSlideshow:a,StripShowcase:a,Accordion:a,Freestyle:a,Collage:a,Honeycomb:a,SlideShowGallery:a,TPA3DGallery:a,TPA3DCarousel:a,LinkBar:function(t){t.panelHelpers.openOrganizeSocialIconsPanel()},SpotifyPlayer:function(t,e){o.openIframe(t,null,function(n){var i=t.components.data.get(e);n&&n.uri&&n.uri!==i.uri&&(t.components.data.update(e,{uri:n.uri}),t.history.add("Change Spotify Track"))})},TinyMenu:u,VerticalMenu:u}}),define("core/utils/componentPreviewReadyPlugins/componentPastePlugins",["lodash"],function(t){"use strict";function e(e,n){return t.isEqual(n.controllerRef,e.controllerRef)&&t.isEqual(n.role,e.role)}function n(n,i){var o=function(e,n){var i=n.id&&e.components.get.byId(n.id);return i&&e.components.is.exist(i)?t.omit(n,"id"):n}(n,t.cloneDeep(i)),r=n.documentServices.platform.serialization.getConnectedComponents(o),s=t.transform(r,function(i,o,r){i[r]=function(n,i,o){var r=n.components.get.byId(i,n.documentServices.pages.getFocusedPageId());if(!r)return[];var s=n.documentServices.platform.controllers.connections.get(r);return t.reject(o,function(n){return t.find(s,t.partial(e,n))})}(n,r,o)},{});return n.documentServices.platform.serialization.setConnectedComponents(o,s)}var i="platform.components.AppController";return{removeConnectedComponentsIfAlreadyExist:n,removeSerializedDataId:function(e,n){return n.componentType===i?n:t.omit(n,"id")}}}),define("core/utils/componentPreviewReadyPlugins/componentPreviewReadyPlugins",["lodash","core/utils/componentPreviewReadyPlugins/formPlugin","core/utils/componentPreviewReadyPlugins/componentPastePlugins"],function(t,e,n){"use strict";return[function(n,i){var o=i.components.get.byType(n);t.forEach(o,function(n){var o=i.components.data.get(n),r=t.clone(o);e.updateDataWithDefaults(o,i),t.isEqual(o,r)||i.components.data.update(n,o)})}.bind(null,["wysiwyg.viewer.components.ContactForm","wysiwyg.viewer.components.DynamicContactForm","wysiwyg.common.components.subscribeform.viewer.SubscribeForm"]),function(t){t.registerPasteComponentPlugin("platform.components.AppController",n.removeConnectedComponentsIfAlreadyExist),t.registerPasteComponentPlugin("*",n.removeSerializedDataId)}]}),define("core/utils/pageUtils/blogTypeUtils",[],function(){"use strict";var t={isBlog:function(t,e){return!!e.appInnerID&&"blog"===t.documentServices.wixapps.classics.getPackageName(e.appInnerID)},isBlogSpecialPage:function(t){return"7326bfbb-4b10-4a8e-84c1-73f776051e10"===t.appPageId},isBlogSectionPage:function(e,n){return t.isBlog(e,n)&&!t.isBlogSpecialPage(n)}};return t}),define("core/utils/pageUtils/dynamicTypeUtils",["lodash"],function(t){"use strict";function e(e,n){return t.isObject(function(e,n){var i=t.get(n,"id")&&e.documentServices.pages.getReference(n.id);return i&&e.documentServices.routers.getRouterRef.byPage(i)}(e,n))}return{isDynamicPage:e}}),define("core/utils/pageUtils/tpaTypeUtils",[],function(){"use strict";var t={isTPA:function(t){return!!t.tpaApplicationId},isTPASpecialPage:function(e,n,i){var o=e.pages.isContainsCompWithType(n.id,e.documentServices.tpa.constants.COMP_TYPES.TPA_MULTI_SECTION),r=!i||i&&!e.documentServices.routers.getRouterDataForPageIfExist(n.id);return t.isTPA(n)&&o&&r},isPageNotVisibleInPagesMenu:function(t,e){return t.documentServices.tpa.isPageMarkedAsHideFromMenu(e.tpaApplicationId,e.tpaPageId)}};return t}),define("core/utils/pageUtils/wixStoreTypeUtils",["lodash","core/utils/pageUtils/tpaTypeUtils"],function(t,e){"use strict";function n(t,n,i){return function(t,n){if(e.isTPA(n)){var i=t.documentServices.tpa.section.getPageData(n.id).appData;return i&&i.appDefinitionId}}(n,i)===t}function i(t,e){return e.tpaPageId===t}var o={PRODUCT_PAGE:"product_page",SHOPPING_CART_PAGE:"shopping_cart",THANK_YOU_PAGE:"thank_you_page"};return{isWixStore:t.partial(n,"1380b703-ce81-ff05-f115-39571d94dfcd"),isWixStoreCartPage:t.partial(i,o.SHOPPING_CART_PAGE),isWixStoreThankYouPage:t.partial(i,o.THANK_YOU_PAGE),isWixStoreProductPage:t.partial(i,o.PRODUCT_PAGE)}}),define("core/mixins/editorAPIMixin",["prop-types"],function(t){"use strict";return{contextTypes:{editorAPI:t.object},getEditorAPI:function(){return this.context.editorAPI}}}),define("core/app/lazyComponent",["react","lodash","coreUtilsLib"],function(t,e,n){"use strict";var i={},o={};return t.createClass({displayName:"LazyLoader",statics:{isLoaded:function(t){return e.has(i,t)}},componentWillMount:function(){},componentWillReceiveProps:function(t){this.props.moduleName!==t.moduleName&&(o[this.props.moduleName]=e.without(o[this.props.moduleName],this))},componentWillUnmount:function(){o[this.props.moduleName]=e.without(o[this.props.moduleName],this)},render:function(){var r=this.props.moduleName;if(r&&!i.hasOwnProperty(r)){var s=function(t){return t.split(".")[0]}(this.props.moduleName),a=function(t){return t.split(".").slice(1)}(this.props.moduleName);if(require.defined(s)){var u=e.get(require(s),a);u?i[r]=u:n.log.warn("(lazyComponent.js) -> Module [["+r+"]] has not yet loaded. It is possible that this has not yet been implemented in the editor.")}else o.hasOwnProperty(r)||(o[r]=[]),e.includes(o[r],this)||o[r].push(this),require([s],function(t,r,s){for(var a=s,u=0;u<r.length;u++){if(!a.hasOwnProperty(r[u]))return void n.log.warn("(lazyComponent.js) -> Module [["+t+"]] has not yet loaded. It is possible that this has not yet been implemented in the editor.");a=a[r[u]]}i[t]=a,e.forEach(o[t],function(t){e.has(t.props,"onLoad")?t.props.onLoad():t.forceUpdate()})}.bind(null,r,a))}if(!this.props.placeHolder&&i[r]){var c=e.omit(this.props,["moduleName"]);return t.createElement(i[r],c)}return null}})}),define("core/app/designManager",["lodash"],function(t){"use strict";function e(e,n){return!t.isUndefined(o[e])&&!t.isUndefined(o[e][n.charas])}function n(n,i){return t(n.components.getAllComponents()).filter(t.flow(n.components.getType,t.partial(t.includes,i))).map(function(t){return{compRef:t,design:n.components.design.get(t)}}).reject(function(i){var o=n.components.getType(i.compRef),r=i.design;return function(e){var n=(e=e||this.props.compDesign).cssStyle;return t(n).keys().every(function(e){return t.isNull(n[e])})}(r)||e(o,r)}).uniqBy("design.charas").value()}var i={},o={};return{getPersonalizedDesigns:n,addPersonalizedDesign:function(e,n){t.isUndefined(i[e])&&(i[e]={}),i[e][n.charas]=n},removePersonalizedDesign:function(e,n){delete i[e][n.charas],t.isEmpty(i[e])&&delete i[e]},addThemePresetDesign:function(e,n){t.isUndefined(o[e])&&(o[e]={}),o[e][n.charas]=n},isThemeDesign:e}}),define("core/app/premiumServicesAPI",["jquery","lodash","util"],function(t,e,n){"use strict";function i(n,i,a){var u=t.ajax({type:"GET",dataType:"json",url:s+n});u.done(function(t,n){if("success"!==n)a();else{var s=function(t){return e.has(t,"payload.domain.domainName")&&e.has(t,"payload.domain.checkStatus")&&t.payload.domain.checkStatus===o}(t),u=function(t){var n=e.get(t,"payload.domain.domainName","");return e.isEmpty(n)||e.includes(n,r)||(n=r+n),e.isEmpty(n)?null:n}(t),c=function(t){return!e.isNil(e.get(t,"payload.plan.cycle"))}(t);i({isDomainConnected:s,sitePublishedDomain:u,isSitePremium:c})}}),u.fail(a)}var o=0,r="http://",s=n.serviceTopology.premiumStateApiUrl;return s=s?s.replace(/wix\/getTpaPremiumState/,"premium-management/external/getDocPremiumState?siteGuid="):"//editor.wix.com/_api/premium-management/external/getDocPremiumState?siteGuid=",{getSiteDomainInfo:i}}),define("core/utils/menuUtils/tpaPages",["lodash","core/utils/pageUtils/tpaTypeUtils"],function(t,e){"use strict";var n={getSectionPagesDataList:function(n,i){var o=function(n,i){return t(n).filter(t.partial(e.isTPASpecialPage,i)).map("tpaApplicationId").uniq().value()}(i,n);return t.filter(i,function(i){return t.includes(o,i.tpaApplicationId)&&!e.isTPASpecialPage(n,i)})},getSpecialPagesDataList:function(n,i){return t.filter(i,t.partial(e.isTPASpecialPage,n))},getSpecialPagesDataListByTPAId:function(e,i,o){return t.filter(n.getSpecialPagesDataList(e,o||e.documentServices.pages.getPagesData()),["tpaApplicationId",i])}};return n}),define("core/utils/menuUtils/blogPages",["lodash","core/utils/pageUtils/blogTypeUtils"],function(t,e){"use strict";return{getSectionPagesDataList:function(n,i){return t.filter(i,t.partial(e.isBlogSectionPage,n))},getSpecialPagesDataList:function(n,i){return t.filter(i,e.isBlogSpecialPage)}}}),define("core/utils/menuUtils/menuLogic",["lodash","core/utils/menuUtils/tpaPages","core/utils/menuUtils/blogPages","core/utils/pageUtils/blogTypeUtils","core/utils/pageUtils/tpaTypeUtils","core/utils/pageUtils/dynamicTypeUtils"],function(t,e,n,i,o,r){"use strict";var s=i.isBlog,a=o.isTPA;return{isSpecialPage:function(t,e){return i.isBlogSpecialPage(e)||o.isTPASpecialPage(t,e)||r.isDynamicPage(t,e)},isSubPageMenuItem:function(t,e){return this.isSpecialPage(t,e)&&!o.isPageNotVisibleInPagesMenu(t,e)},getSectionPagesIds:function(i,o){var r=e.getSectionPagesDataList(i,o),s=n.getSectionPagesDataList(i,o);return t.union(t.map(r,"id"),t.map(s,"id"))},getSpecialPagesListBySectionPageOrBySibling:function(t,i,o){if(i){if(s(t,i))return function(t,e){return n.getSpecialPagesDataList(t,e||t.documentServices.pages.getPagesData())}(t,o);if(a(i))return function(t,n,i){return e.getSpecialPagesDataListByTPAId(t,n,i)}(t,i.tpaApplicationId,o)}return[]},getSectionPageDataBySpecialPage:function(i,o){var r,u=i.documentServices.pages.getPagesData();if(s(i,o))return t.head(n.getSectionPagesDataList(i,u));if(a(o)){r=e.getSectionPagesDataList(i,u);var c=t.find(r,{tpaApplicationId:o.tpaApplicationId});if(!c){var l=i.homePage.get();c=t.find(u,{id:l})}return c}return o}}}),define("core/utils/pageUtils/pageTitleUtils",["util"],function(t){"use strict";var e=40;return{generateDuplicatedTitle:function(n){var i,o=new RegExp(/copy\s(\d+\s|)of\s/i);return o.test(n)?(i=RegExp.$1?parseInt(RegExp.$1,10)+1:2,n.replace(o,"Copy "+i+" of ")):((n=t.translate("Pages_Actions_Duplicate_CopyOf")+" "+n).length>e&&(n=n.substr(0,e-3)+"..."),n)},convertPageNameToUrl:function(e){var n=e.replace(/\s/g,"-");return t.validate.byInvalidCharacters(t.validationExpressions.invalidUrlCharacters)(n)?n.toLowerCase():"blank"}}}),define("core",["core/utils/addUtil","core/utils/AddPanelDragHandler","core/utils/AddPanelSectionDragHandler","core/utils/AttachHandler","core/utils/AttachHandlerExperimentAttachImprovements","core/utils/updateLayoutUtil","core/utils/layoutConstraintsUtil/LayoutConstraintsUtil","core/utils/updateDataUtil","core/utils/updatePropertiesUtil","core/utils/DragConstraintsHandler","core/utils/layoutTransitionsUtil","core/utils/SnapToHandler","core/utils/stageUtils","core/utils/scrollUtils","core/utils/compControlsMeasurer","core/utils/fixedPositionPlugins/fixedPositionPlugins","core/utils/social","core/utils/spotifyUtils","core/utils/uiControlsBIUtil","core/utils/componentsDefaultAction","core/utils/componentPreviewReadyPlugins/componentPreviewReadyPlugins","core/utils/compsSectionsAnalyzer","core/utils/sectionsReorganizeUtil","core/utils/pageUtils/blogTypeUtils","core/utils/pageUtils/dynamicTypeUtils","core/utils/pageUtils/tpaTypeUtils","core/utils/pageUtils/wixStoreTypeUtils","core/utils/mouseMoveActions/sectionDrag","core/utils/mouseCoordinatesHandler","core/utils/gridLinesUtil","core/mixins/editorAPIMixin","core/app/constants","core/app/lazyComponent","core/app/styleManager","core/app/designManager","core/app/premiumServicesAPI","core/bi/bi","core/utils/menuUtils/menuLogic","core/utils/mediaManagerPresetUtil","core/utils/pageUtils/pageTitleUtils"],function(t,e,n,i,o,r,s,a,u,c,l,p,d,g,m,h,f,y,P,v,S,C,T,I,x,A,w,b,E,O,R,M,_,D,L,U,F,B,N,k){"use strict";return{constants:M,utils:{pageTitleUtils:k,menuLogic:B,addUtil:t,AddPanelDragHandler:e,AddPanelSectionDragHandler:n,AttachHandler:i,AttachHandlerExperimentAttachImprovements:o,DragConstraintsHandler:c,updateLayoutUtil:r,LayoutConstraintsUtil:s,updateDataUtil:a,updatePropertiesUtil:u,layoutTransitionsUtil:l,SnapToHandler:p,stageUtils:d,scrollUtils:g,fixedPositionUtils:h,social:f,spotifyUtils:y,compControlsMeasurer:m,uiControlsBIUtil:P,componentsDefaultAction:v,compsSectionsAnalyzer:C,sectionsReorganizeUtil:T,componentPreviewReadyPlugins:S,blogTypeUtils:I,dynamicTypeUtils:x,tpaTypeUtils:A,wixStoreTypeUtils:w,mouseCoordinatesHandler:E,gridLinesUtil:O,mediaManagerPresetUtil:N,sectionDrag:b},mixins:{editorAPIMixin:R},lazyComponent:_,styleManager:D,designManager:L,premiumServicesAPI:U,bi:F}});
//# sourceMappingURL=core.min.js.map